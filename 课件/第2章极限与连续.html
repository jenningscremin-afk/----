<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']],
            processEscapes: true,
            processEnvironments: true,
            packages: {'[+]': ['ams', 'noerrors', 'color']},
            macros: {
                RR: '{\\mathbb{R}}',
                NN: '{\\mathbb{N}}',
                ZZ: '{\\mathbb{Z}}',
                QQ: '{\\mathbb{Q}}',
                CC: '{\\mathbb{C}}'
            }
        },
        options: {
            ignoreHtmlClass: 'tex2jax_ignore',
            processHtmlClass: 'tex2jax_process',
            renderActions: {
                addMenu: []
            }
        },
        startup: {
            // This prevents MathJax from running automatically on page load.
            // We will call it manually after our slides are created.
            ready: () => {
                console.log('MathJax is ready, but we will render manually.');
                MathJax.startup.defaultReady();
            },
            // Add this line to ensure the initial typeset is fully disabled
            pageReady: () => {}
        }
    };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
    <style>
        /* é¡µé¢æ•´ä½“æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif;
            background: #f0f2f5; /* ä½¿ç”¨æ·¡ç°è‰²èƒŒæ™¯ */
            overflow: hidden; /* é˜²æ­¢bodyæ»šåŠ¨ */
        }

        /* å¹»ç¯ç‰‡ä¸»å®¹å™¨ */
        .slide-container {
            width: 100%;
            height: 100vh;
            display: flex;
            position: relative;
        }

        /* å·¦ä¾§æ–‡æœ¬å†…å®¹åŒºåŸŸ */
        .left-content {
            width: 50%;
            height: 100vh;
            padding: 40px 50px;
            background: #ffffff;
            overflow-y: auto; /* å†…å®¹è¿‡é•¿æ—¶å…è®¸æ»šåŠ¨ */
            font-size: 17px;
            line-height: 1.9;
            color: #333;
        }

        /* å³ä¾§å¯è§†åŒ–åŒºåŸŸ */
        .right-visual {
            width: 50%;
            height: 100vh;
            background: #fdfdfd;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            border-left: 1px solid #e0e0e0;
        }

        /* å¹»ç¯ç‰‡å¯è§æ€§ä¸åŠ¨ç”» */
        .slide {
            display: none;
            animation: fadeIn 0.6s ease-in-out;
        }

        .slide.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* æ ‡é¢˜æ’ç‰ˆ */
        h1 { color: #1a1a2e; font-size: 36px; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 4px solid #4a90e2; }
        h2 { color: #34495e; font-size: 28px; margin: 30px 0 15px; }
        h3 { color: #555; font-size: 24px; margin: 25px 0 10px; }
        h4 { color: #666; font-size: 20px; margin: 20px 0 10px; }

        /* å†…å®¹æ¨¡å—æ ·å¼ */
        .definition, .theorem, .example, .note {
            padding: 18px 25px;
            margin: 20px 0;
            border-radius: 8px;
            border-left-width: 5px;
            border-left-style: solid;
        }
        .definition { background: #eaf2f8; border-color: #3498db; }
        .theorem { background: #fef5e7; border-color: #f39c12; }
        .example { background: #e8f8f5; border-color: #2ecc71; }
        .note { background: #fdedec; border-color: #e74c3c; font-style: italic; }

        .formula-highlight {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.25em;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        
        /* MathJax SVG å…¬å¼æ ·å¼ä¼˜åŒ– */
        .MathJax {
            outline: 0;
            display: inline-block;
        }

        .MathJax_Display {
            text-align: center !important;
            margin: 1em 0 !important;
        }

        mjx-container[jax="SVG"] {
            display: inline-block;
            line-height: 0;
        }

        mjx-container[jax="SVG"][display="true"] {
            display: block;
            text-align: center;
            margin: 1em 0;
        }

        mjx-container[jax="SVG"] svg {
            display: inline-block;
            vertical-align: middle;
        }

        mjx-container[jax="SVG"][display="true"] svg {
            display: block;
            margin: 0 auto;
        }

        /* ç¡®ä¿SVGå…¬å¼åœ¨ä¸åŒè®¾å¤‡ä¸Šçš„æ¸…æ™°åº¦ */
        mjx-container svg {
            shape-rendering: geometricPrecision;
            text-rendering: geometricPrecision;
        }

        /* å¼ºåˆ¶æ˜¾ç¤ºSVGæ•°å­¦å…¬å¼ */
        mjx-container[jax="SVG"] {
            visibility: visible !important;
            opacity: 1 !important;
        }

        mjx-container[jax="SVG"] svg {
            visibility: visible !important;
            opacity: 1 !important;
            width: auto !important;
            height: auto !important;
        }

        /* ç¡®ä¿æ•°å­¦å…¬å¼å®¹å™¨æ­£ç¡®æ˜¾ç¤º */
        .slide-container .left-content mjx-container {
            display: inline-block !important;
        }

        .slide-container .left-content mjx-container[display="true"] {
            display: block !important;
            text-align: center !important;
        }

        /* Stage 3 æ–°å¢ï¼šstep-stack ä¸æ•™å¸ˆæç¤ºæ ·å¼ */
        .step-stack { display: flex; flex-direction: column; gap: 10px; }
        .step-item { border: 1px dashed rgba(79,70,229,0.3); border-radius: 12px; padding: 10px 12px; background: rgba(79,70,229,0.04); display: none; }
        .step-item.active { display: block; background: rgba(79,70,229,0.12); border-color: #4f46e5; }
        .step-btn { margin-top: 8px; padding: 6px 10px; border-radius: 8px; border: 1px solid #e5e7eb; background: #ffffff; cursor: pointer; }
        .prompt-card { background: rgba(79,70,229,0.08); border: 1px solid rgba(79,70,229,0.18); border-radius: 12px; padding: 12px; }
        .teacher-note { background: #fff7ed; border: 1px solid #fed7aa; border-radius: 12px; padding: 12px; }
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* æ‚¬æµ®AIæŒ‰é’®æ ·å¼ */
        .ai-float-btn {
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            z-index: 1000;
            border: none;
            color: white;
            font-size: 24px;
            animation: pulse 2s infinite;
        }

        .ai-float-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.6);
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }

        .ai-float-btn.show {
            display: flex;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
            }
            50% {
                box-shadow: 0 4px 20px rgba(102, 126, 234, 0.8);
            }
            100% {
                box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
            }
        }

        /* AIæŒ‰é’®æç¤ºæ–‡å­— */
        .ai-float-btn::before {
            content: "AIæ•°åˆ—åŠ©æ‰‹";
            position: absolute;
            right: 70px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .ai-float-btn:hover::before {
            opacity: 1;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
.ai-float-btn {
                bottom: 80px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 20px;
            }

            .ai-float-btn::before {
                right: 60px;
                font-size: 12px;
                padding: 6px 10px;
            }
        }

        /* å¯è§†åŒ–Canvasæ ·å¼ */
        canvas {
            max-width: 90%;
            max-height: 90%;
            border-radius: 8px;
        }

        /* å¯¼èˆªæ æ ·å¼ - é‡æ–°è®¾è®¡ä¸ºå³ä¸‹è§’å°æ§ä»¶ */
        .nav-container {
            position: fixed;
            bottom: 15px;
            right: 15px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.3);
            padding: 6px 10px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(5px);
            opacity: 0.6;
            transition: opacity 0.3s ease;
            font-size: 12px;
        }

        .nav-container:hover {
            opacity: 1;
        }

        .nav-btn {
            padding: 4px 8px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            cursor: pointer;
            font-size: 10px;
            transition: all 0.3s ease;
        }
        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.4);
            transform: scale(1.05);
        }

        .slide-number {
            color: white;
            font-size: 10px;
            padding: 0 6px;
            font-weight: normal;
        }


        
        /* å…¶ä»–UIå…ƒç´  */
        ul, ol { margin-left: 25px; }
        li { margin: 10px 0; }

        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th { background: #3498db; color: white; padding: 12px; text-align: left; }
        td { padding: 10px; border: 1px solid #ddd; }
        tr:nth-child(even) { background-color: #f9f9f9; }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .slide-container {
                flex-direction: column;
            }
            .left-content, .right-visual {
                width: 100%;
                height: 50vh;
            }
            .left-content {
                padding: 20px;
                font-size: 14px;
            }
            .nav-container {
                bottom: 10px;
                right: 10px;
                
                padding: 4px 8px;
                font-size: 10px;
            }
            .nav-btn {
                padding: 3px 6px;
                font-size: 9px;
            }
            canvas {
                max-width: 100%;
                height: auto;
            }
        }

        /* æ‰“å°æ ·å¼ */
        @media print {
            .nav-container {
                display: none;
            }
            .slide {
                page-break-after: always;
            }
        }

        /* åŠ è½½æŒ‡ç¤ºå™¨ */
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 18px;
            color: #3498db;
            z-index: 9999;
        }

        /* æ— éšœç¢æ”¹è¿› */
        .nav-btn:focus {
            outline: 2px solid #3498db;
            outline-offset: 2px;
        }

        /* é”™è¯¯æç¤º */
        .error-message {
            color: #e74c3c;
            text-align: center;
            padding: 20px;
            font-size: 16px;
        }



        /* Lab Menu Button Styles */
        .lab-menu-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 999;
            background: rgba(52, 73, 94, 0.8);
            color: #ecf0f1;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .lab-menu-button:hover {
            background: rgba(52, 73, 94, 1);
            transform: scale(1.1);
        }

        /* Lab Menu Dropdown */
        .lab-menu {
            position: fixed;
            bottom: 90px;
            right: 30px;
            z-index: 998;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            padding: 15px;
            min-width: 280px;
            max-height: 400px;
            overflow-y: auto;
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: all 0.3s ease;
        }

        .lab-menu.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .lab-menu h3 {
            margin: 0 0 15px 0;
            color: #2c3e50;
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            border-bottom: 2px solid #3498db;
            padding-bottom: 8px;
        }

        .lab-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .lab-item {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            text-decoration: none;
            padding: 10px 8px;
            border-radius: 8px;
            text-align: center;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.2s ease;
            display: block;
        }

        .lab-item:hover {
            background: linear-gradient(135deg, #2980b9, #3498db);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        /* Step Stack Styles for Interactive Learning */
        .step-stack {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
        }

        .step-item {
            display: none;
            padding: 15px;
            margin: 10px 0;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .step-item.active {
            display: block;
            animation: fadeInUp 0.5s ease;
        }

        .step-item.completed {
            background: #e8f5e8;
            border-left: 3px solid #27ae60;
        }

        .step-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .step-btn:hover {
            background: linear-gradient(135deg, #2980b9, #3498db);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        .step-btn.completed {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .step-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
        }

        .prompt-card {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border: 1px solid #f39c12;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            position: relative;
        }

        .prompt-card::before {
            content: "ğŸ’¡";
            position: absolute;
            top: -10px;
            left: 15px;
            background: #f39c12;
            color: white;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .teacher-note {
            background: linear-gradient(135deg, #e8f4fd, #dbeafe);
            border: 1px solid #3498db;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            position: relative;
            font-style: italic;
        }

        .teacher-note::before {
            content: "ğŸ‘©â€ğŸ«";
            position: absolute;
            top: -10px;
            left: 15px;
            background: #3498db;
            color: white;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .knowledge-objective {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .student-pain-points {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

    </style>
</head>
<body>
    <!-- Lab Menu Button -->
    <button class="lab-menu-button" onclick="toggleLabMenu()" title="ç¬¬äºŒç« å®éªŒå®¤">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M9 11H5a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2h-4"/>
            <path d="M9 7V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v3"/>
            <circle cx="12" cy="13" r="1"/>
        </svg>
    </button>

    <!-- Lab Menu Dropdown -->
    <div class="lab-menu" id="labMenu">
        <h3>ç¬¬äºŒç« å®éªŒå®¤</h3>
        <div class="lab-grid">
            <a href="../ç½‘é¡µèµ„æº/lab 2-1.html" class="lab-item" target="_blank">Lab 2-1</a>
            <a href="../ç½‘é¡µèµ„æº/lab 2-2.html" class="lab-item" target="_blank">Lab 2-2</a>
            <a href="../ç½‘é¡µèµ„æº/lab 2-3.html" class="lab-item" target="_blank">Lab 2-3</a>
            <a href="../ç½‘é¡µèµ„æº/lab 2-4.html" class="lab-item" target="_blank">Lab 2-4</a>
            <a href="../ç½‘é¡µèµ„æº/lab 2-5.html" class="lab-item" target="_blank">Lab 2-5</a>
            <a href="../ç½‘é¡µèµ„æº/lab 2-6.html" class="lab-item" target="_blank">Lab 2-6</a>
            <a href="../ç½‘é¡µèµ„æº/lab 2-7.html" class="lab-item" target="_blank">Lab 2-7</a>
            <a href="../ç½‘é¡µèµ„æº/lab 2-8.html" class="lab-item" target="_blank">Lab 2-8</a>
            <a href="../ç½‘é¡µèµ„æº/lab 2-9.html" class="lab-item" target="_blank">Lab 2-9</a>
            <a href="../ç½‘é¡µèµ„æº/lab 2-10.html" class="lab-item" target="_blank">Lab 2-10</a>
            <a href="../ç½‘é¡µèµ„æº/lab 2-11.html" class="lab-item" target="_blank">Lab 2-11</a>
            <a href="../ç½‘é¡µèµ„æº/lab 2-12.html" class="lab-item" target="_blank">Lab 2-12</a>
            <a href="../ç½‘é¡µèµ„æº/lab 2-13.html" class="lab-item" target="_blank">Lab 2-13</a>
        </div>
    </div>

    <!-- å¹»ç¯ç‰‡å°†åœ¨æ­¤å¤„åŠ¨æ€ç”Ÿæˆ -->
    <div id="slidesContainer"></div>

    <!-- å¯¼èˆªæ§ä»¶ -->
    <div class="nav-container">
        <button class="nav-btn" onclick="prevSlide()" aria-label="ä¸Šä¸€é¡µ">ä¸Šä¸€é¡µ</button>
        <span class="slide-number" id="slideNumber">1 / 48</span>
        <button class="nav-btn" onclick="nextSlide()" aria-label="ä¸‹ä¸€é¡µ">ä¸‹ä¸€é¡µ</button>
        <button class="nav-btn" onclick="autoPlay()" id="autoPlayBtn" aria-label="è‡ªåŠ¨æ’­æ”¾">è‡ªåŠ¨æ’­æ”¾</button>
        <button class="nav-btn" onclick="forceRerenderMath()" id="rerenderMathBtn" style="background: #f59e0b; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-left: 10px;">é‡æ–°æ¸²æŸ“å…¬å¼</button>
    </div>

    <!-- AIæ•°åˆ—åŠ©æ‰‹æ‚¬æµ®æŒ‰é’® -->
    <button class="ai-float-btn" id="aiFloatBtn" title="æ‰“å¼€AIæ•°åˆ—åŠ©æ‰‹">ğŸ¤–</button>

    <script>
        // åŒ…å«æ‰€æœ‰å¹»ç¯ç‰‡å†…å®¹çš„æ•°ç»„
        const slidesData = [
            {
                title: "ç¬¬2ç«  æé™ä¸è¿ç»­",
                content: `<h1>ç¬¬2ç«  æé™ä¸è¿ç»­</h1><h2>æœ¬ç« å†…å®¹</h2><ul><li><strong>01</strong> æé™çš„æ¦‚å¿µ</li><li><strong>02</strong> æé™çš„æ€§è´¨å’Œè¿ç®—æ³•åˆ™</li><li><strong>03</strong> ä¸¤ä¸ªé‡è¦æé™åŠæ— ç©·å°çš„æ¯”è¾ƒ</li><li><strong>04</strong> å‡½æ•°çš„è¿ç»­æ€§</li></ul><div class="note">å‡½æ•°æé™çš„æ¦‚å¿µå’Œæ€æƒ³æ˜¯æ•´ä¸ªé«˜ç­‰æ•°å­¦çš„çµé­‚, éšåæˆ‘ä»¬è¦å­¦ä¹ çš„å¯¼æ•°ã€ç§¯åˆ†ã€çº§æ•°ç­‰æ¦‚å¿µçš„å»ºç«‹, éƒ½æ˜¯ä»¥æé™æ€æƒ³ä¸ºå‡ºå‘ç‚¹çš„, æ²¡æœ‰æé™å°±æ²¡æœ‰æ•´ä¸ªå¾®ç§¯åˆ†.</div>`,
                animation: "title"
            },
            {
                title: "è¯¾å ‚ç›®æ ‡ä¸å­¦ç”Ÿç—›ç‚¹",
                content: `
                <div class="knowledge-objective">
                    <h3>ğŸ¯ æœ¬èŠ‚è¯¾å­¦ç”Ÿéœ€è¦æŒæ¡çš„3ä»¶äº‹</h3>
                    <ol>
                        <li><strong>ç†è§£æé™çš„æœ¬è´¨</strong>ï¼šèƒ½ç”¨è‡ªå·±çš„è¯è§£é‡Š"æ— é™æ¥è¿‘"çš„å«ä¹‰</li>
                        <li><strong>åˆ¤æ–­æ”¶æ•›ä¸å‘æ•£</strong>ï¼šèƒ½å¤Ÿè¯†åˆ«æ•°åˆ—æ˜¯å¦æœ‰æé™</li>
                        <li><strong>æŒæ¡æ±‚æé™çš„åŸºæœ¬æ–¹æ³•</strong>ï¼šç›´æ¥ä»£å…¥ã€å› å¼åˆ†è§£ã€æœ‰ç†åŒ–ç­‰æŠ€å·§</li>
                    </ol>
                </div>
                <div class="student-pain-points">
                    <h3>âš ï¸ å­¦ç”Ÿå¸¸è§å›°éš¾ç‚¹</h3>
                    <ul>
                        <li><strong>ç¬¦å·ç†è§£</strong>ï¼š$\lim_{n\to\infty}$ã€$\varepsilon$-$N$å®šä¹‰çœ‹ä¸æ‡‚</li>
                        <li><strong>æ¦‚å¿µæ··æ·†</strong>ï¼šæé™å€¼ vs æ•°åˆ—çš„é¡¹ï¼Œæ— é™æ¥è¿‘ vs ç­‰äº</li>
                        <li><strong>è®¡ç®—æŠ€èƒ½</strong>ï¼šé‡åˆ°0/0å‹ä¸çŸ¥é“å¦‚ä½•å¤„ç†</li>
                    </ul>
                    <div class="teacher-note">
                        <strong>æ•™å­¦ç­–ç•¥</strong>ï¼šå¤šç”¨ç”Ÿæ´»ç±»æ¯”ï¼Œåˆ†æ­¥éª¤å±•ç¤ºè§£é¢˜è¿‡ç¨‹ï¼Œå¼ºè°ƒ"å…ˆè¯•åæƒ³"çš„è§£é¢˜ä¹ æƒ¯
                    </div>
                </div>`,
                animation: "objective"
            },
            {
                title: "1. è®¤è¯†æ•°åˆ—",
                content: `
                <h2>ğŸ¢ ä»ç”Ÿæ´»ä¸­è®¤è¯†æ•°åˆ—</h2>
                <div class="prompt-card">
                    <strong>æ•™å¸ˆæé—®</strong>ï¼šæˆ‘ä»¬ç”Ÿæ´»ä¸­ä¼šé‡åˆ°å¾ˆå¤šæŒ‰é¡ºåºæ’åˆ—çš„æ•°å­—ï¼Œæ¯”å¦‚æ¥¼å±‚å·1, 2, 3... è¿™ç§æŒ‰ä¸€å®šæ¬¡åºæ’åˆ—çš„ä¸€åˆ—æ•°ï¼Œæˆ‘ä»¬å«å®ƒä»€ä¹ˆï¼Ÿ
                </div>

                <div class="step-stack" id="sequence-intro">
                    <div class="step-item active" data-step="1">
                        <h4>ç”Ÿæ´»ä¸­çš„æ•°åˆ—ä¾‹å­</h4>
                        <ul>
                            <li>ğŸ¢ æ¥¼å±‚å·ï¼š1æ¥¼ã€2æ¥¼ã€3æ¥¼...</li>
                            <li>ğŸ“± æ‰‹æœºå·ç çš„æ¯ä¸€ä½</li>
                            <li>ğŸµ éŸ³é˜¶ï¼šdoã€reã€miã€fa...</li>
                            <li>ğŸ“… æ—¥æœŸï¼š1å·ã€2å·ã€3å·...</li>
                        </ul>
                        <button class="step-btn" data-action="next">ä¸‹ä¸€æ­¥ï¼šæ•°å­¦å®šä¹‰</button>
                    </div>

                    <div class="step-item" data-step="2">
                        <div class="definition">
                            <strong>å®šä¹‰1</strong> åœ¨æŸä¸€æ³•åˆ™ä¸‹,å½“ $n(n\in N^{+})$ ä¾æ¬¡å– $1,2,3,\cdots,n,\cdots$ æ—¶,å¯¹åº”çš„å®æ•°æ’æˆä¸€åˆ—æ•° $x_{1},x_{2},x_{3},...,x_{n},\cdots$,è¿™åˆ—æ•°å°±ç§°ä¸ºæ•°åˆ—,è®°ä½œ $\\{x_n\\}$ã€‚
                        </div>
                        <p>æ•°åˆ—ä¸­çš„æ¯ä¸€ä¸ªæ•°ç§°ä¸ºæ•°åˆ—çš„é¡¹,ç¬¬né¡¹ $x_{n}$ ç§°ä¸ºæ•°åˆ—çš„ä¸€èˆ¬é¡¹æˆ–é€šé¡¹ã€‚</p>
                        <button class="step-btn" data-action="next">ä¸‹ä¸€æ­¥ï¼šå¸¸è§è¯¯åŒº</button>
                    </div>

                    <div class="step-item" data-step="3">
                        <h4>âš ï¸ å¸¸è§è¯¯åŒºçº æ­£</h4>
                        <div style="background: #ffe6e6; padding: 15px; border-radius: 8px; margin: 10px 0;">
                            <strong>âŒ è¯¯åŒº</strong>ï¼šè®¤ä¸ºæ•°åˆ—å¿…é¡»æ˜¯è¿ç»­çš„æ•´æ•°
                        </div>
                        <div style="background: #e6ffe6; padding: 15px; border-radius: 8px; margin: 10px 0;">
                            <strong>âœ… çº æ­£</strong>ï¼šæ•°åˆ—å¯ä»¥æ˜¯ä»»ä½•æŒ‰é¡ºåºæ’åˆ—çš„æ•°ï¼Œå¦‚1, 4, 9, 16...ï¼ˆå¹³æ–¹æ•°åˆ—ï¼‰
                        </div>
                        <button class="step-btn completed" data-action="reset">é‡æ–°å¼€å§‹</button>
                    </div>
                </div>`,
                animation: "sequence"
            },
            {
                title: "è§†è§’çš„è½¬å˜ï¼šé«˜ä¸­ vs å¤§å­¦",
                content: `
                <h2>ğŸ” è§†è§’çš„è½¬å˜ï¼šé«˜ä¸­ vs å¤§å­¦</h2>
                <div class="prompt-card">
                    <strong>æ•™å¸ˆä¸²è¯</strong>ï¼šâ€œåœ¨é«˜ä¸­é˜¶æ®µï¼Œæˆ‘ä»¬ç ”ç©¶æ•°åˆ—æ—¶ï¼Œå…³æ³¨çš„æ˜¯å®ƒçš„å†…éƒ¨è§„å¾‹å’Œæœ‰é™æ­¥éª¤ï¼›åˆ°äº†å¤§å­¦ï¼Œæˆ‘ä»¬è¦å…³å¿ƒçš„æ˜¯å®ƒçš„ç»ˆç‚¹å‘½è¿ã€‚â€
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div style="background: rgba(59,130,246,0.08); padding: 18px; border-radius: 12px; border-left: 4px solid #3b82f6;">
                        <h3>é«˜ä¸­æ•°å­¦ï¼šæœ‰é™è§†è§’</h3>
                        <ul>
                            <li><strong>ç ”ç©¶å¯¹è±¡ï¼š</strong>å‰ n é¡¹ï¼ˆn æ˜¯å…·ä½“çš„ã€æœ‰é™çš„ï¼‰</li>
                            <li><strong>æ ¸å¿ƒé—®é¢˜ï¼š</strong>
                                <ul>
                                    <li>é€šé¡¹å…¬å¼ $a_n$ æ˜¯ä»€ä¹ˆï¼Ÿ</li>
                                    <li>å‰ n é¡¹å’Œ $S_n$ å¤šå°‘ï¼Ÿ</li>
                                </ul>
                            </li>
                            <li><strong>å…³é”®è¯ï¼š</strong>ç­‰å·®ã€ç­‰æ¯”ã€é€šé¡¹ã€æ±‚å’Œ</li>
                            <li><strong>è§†è§’ï¼š</strong>å†…éƒ¨ç»“æ„ &amp; æœ‰é™è¿‡ç¨‹</li>
                        </ul>
                    </div>
                    <div style="background: rgba(16,185,129,0.08); padding: 18px; border-radius: 12px; border-left: 4px solid #10b981;">
                        <h3>å¤§å­¦é«˜æ•°ï¼šæ— é™è§†è§’</h3>
                        <ul>
                            <li><strong>ç ”ç©¶å¯¹è±¡ï¼š</strong>æ•´ä¸ªæ•°åˆ—ï¼Œå°¤å…¶æ˜¯æ— é™å¤šé¡¹çš„è¶‹åŠ¿</li>
                            <li><strong>æ ¸å¿ƒé—®é¢˜ï¼š</strong>
                                <ul>
                                    <li>å½“ $n \to \infty$ æ—¶ï¼Œ$a_n$ è¶‹å‘å“ªä¸ªå€¼ï¼Ÿ</li>
                                    <li>æ•°åˆ—æ”¶æ•›è¿˜æ˜¯å‘æ•£ï¼Ÿ</li>
                                </ul>
                            </li>
                            <li><strong>å…³é”®è¯ï¼š</strong>æé™ã€æ”¶æ•›ã€å‘æ•£ã€è¶‹åŠ¿</li>
                            <li><strong>è§†è§’ï¼š</strong>ç»ˆç‚¹è¡Œä¸º &amp; æ— é™è¿‡ç¨‹</li>
                        </ul>
                    </div>
                </div>`,
                animation: "view_shift"
            },
            {
                title: "2. è§‚å¯Ÿè¶‹åŠ¿",
                content: `
                <h2>ğŸƒâ€â™‚ï¸ è§‚å¯Ÿæ•°åˆ—çš„å˜åŒ–è¶‹åŠ¿</h2>
                <div class="prompt-card">
                    <strong>æ•™å¸ˆæé—®</strong>ï¼šæˆ‘ä»¬æ¥çœ‹è¿™ä¸ªæ•°åˆ— $x_n = \frac{n}{n+1}$ã€‚å½“ n=1, 2, 10, 100 æ—¶ï¼Œè¿™ä¸ªæ•°åˆ†åˆ«æ˜¯å¤šå°‘ï¼Ÿä½ å‘ç° n è¶Šæ¥è¶Šå¤§æ—¶ï¼Œè¿™ä¸ªæ•°è¶Šæ¥è¶Šæ¥è¿‘å“ªä¸ªå›ºå®šçš„æ•°å­—ï¼Ÿå®ƒä¼šç­‰äºé‚£ä¸ªæ•°å—ï¼Ÿ
                </div>

                <div class="step-stack" id="trend-observation">
                    <div class="step-item active" data-step="1">
                        <h4>è®©å­¦ç”Ÿè®¡ç®—å‡ ä¸ªå€¼</h4>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                            <p>$x_1 = \frac{1}{1+1} = \frac{1}{2} = 0.5$</p>
                            <p>$x_2 = \frac{2}{2+1} = \frac{2}{3} â‰ˆ 0.667$</p>
                            <p>$x_{10} = \frac{10}{10+1} = \frac{10}{11} â‰ˆ 0.909$</p>
                            <p>$x_{100} = \frac{100}{100+1} = \frac{100}{101} â‰ˆ 0.990$</p>
                        </div>
                        <button class="step-btn" data-action="next">ä¸‹ä¸€æ­¥ï¼šç±»æ¯”ç†è§£</button>
                    </div>

                    <div class="step-item" data-step="2">
                        <h4>ğŸƒâ€â™‚ï¸ è·‘æ­¥ç±»æ¯”</h4>
                        <p><strong>è·‘1000ç±³</strong>ï¼šç¬¬1ç§’è·‘äº†1/2ï¼Œç¬¬2ç§’è·‘äº†2/3ï¼Œç¬¬10ç§’è·‘äº†10/11...è¶Šæ¥è¶Šæ¥è¿‘å…¨ç¨‹ï¼Œä½†æ°¸è¿œå·®ä¸€ç‚¹ç‚¹</p>
                        <h4>ğŸ’§ æ°´æ¯ç±»æ¯”</h4>
                        <p><strong>å€’æ°´</strong>ï¼šæ¯å­å®¹é‡n+1ï¼Œå·²å€’å…¥nï¼Œæ¯”ä¾‹è¶Šæ¥è¶Šæ¥è¿‘æ»¡æ¯(1)ä½†æ°¸è¿œä¸æ»¡</p>
                        <button class="step-btn" data-action="next">ä¸‹ä¸€æ­¥ï¼šè¯¯åŒºçº æ­£</button>
                    </div>

                    <div class="step-item" data-step="3">
                        <h4>âš ï¸ å¸¸è§è¯¯åŒºçº æ­£</h4>
                        <div style="background: #ffe6e6; padding: 15px; border-radius: 8px; margin: 10px 0;">
                            <strong>âŒ è¯¯åŒº1</strong>ï¼šè®¤ä¸ºæ•°åˆ—æœ€ç»ˆä¼šç­‰äº1
                        </div>
                        <div style="background: #e6ffe6; padding: 15px; border-radius: 8px; margin: 10px 0;">
                            <strong>âœ… çº æ­£</strong>ï¼šæ— é™æ¥è¿‘1ä½†æ°¸è¿œä¸ç­‰äº1
                        </div>
                        <div style="background: #ffe6e6; padding: 15px; border-radius: 8px; margin: 10px 0;">
                            <strong>âŒ è¯¯åŒº2</strong>ï¼šåˆ†å­åˆ†æ¯éƒ½è¶‹äºæ— ç©·æ‰€ä»¥æé™ä¸å­˜åœ¨
                        </div>
                        <div style="background: #e6ffe6; padding: 15px; border-radius: 8px; margin: 10px 0;">
                            <strong>âœ… çº æ­£</strong>ï¼šè¦çœ‹æ¯”å€¼çš„è¶‹åŠ¿ï¼Œä¸æ˜¯å•ç‹¬çœ‹åˆ†å­åˆ†æ¯
                        </div>
                        <button class="step-btn completed" data-action="reset">é‡æ–°å¼€å§‹</button>
                    </div>
                </div>`,
                animation: "trend"
            },
            {
                title: "ç»ˆç‚¹è¡Œä¸ºçš„ä¸‰ç§å‘½è¿",
                content: `
                <h2>ğŸ¬ æ•°åˆ—çš„â€œç»ˆç‚¹è¡Œä¸ºâ€</h2>
                <p>æ•°åˆ—å†™åˆ°æ— ç©·æ—¶ï¼Œå¯èƒ½å‡ºç°ä¸‰ç§å…¸å‹å‘½è¿ï¼š</p>
                <ol>
                    <li><strong>æ”¶æ•›ï¼š</strong>é¡¹è¶Šæ¥è¶Šé è¿‘æŸä¸ªå›ºå®šçš„æ•°å€¼</li>
                    <li><strong>å‘æ•£åˆ°æ— ç©·ï¼š</strong>é¡¹ä¸æ–­å¢å¤§ï¼ˆæˆ–å‡å°ï¼‰æ²¡æœ‰ä¸Šç•Œ</li>
                    <li><strong>æ‘†åŠ¨å‘æ•£ï¼š</strong>é¡¹åœ¨å¤šä¸ªå€¼ä¹‹é—´æ¥å›éœ‡è¡</li>
                </ol>
                <div class="teacher-note">â€œæ¥ä¸‹æ¥æˆ‘ä»¬è¦å‘å±•ä¸€ç§è¯­è¨€â€”â€”æé™ï¼Œæ¥ç²¾å‡†æè¿°è¿™äº›å‘½è¿ã€‚â€</div>
                `,
                animation: "terminal_behaviors"
            },
            {
                title: "è§†è§’å‡çº§ï¼šæ•°åˆ—æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°",
                content: `
                <h2>ğŸ” è§†è§’å‡çº§ï¼šæ•°åˆ— = ç‰¹æ®Šçš„å‡½æ•°</h2>
                <p>æ•°åˆ—å¯ä»¥ç†è§£ä¸ºå®šä¹‰åŸŸä»…åŒ…å«æ­£æ•´æ•°çš„å‡½æ•°ï¼š</p>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div style="background: rgba(99,102,241,0.08); padding: 16px; border-radius: 12px; border-left: 4px solid #6366f1;">
                        <h3>æ•°åˆ—å†™æ³•</h3>
                        <p>$\\{x_n\\}: x_1, x_2, x_3, \cdots$</p>
                        <p>ä¾‹ï¼š$x_n=\frac{n}{n+1} = \frac{1}{2}, \frac{2}{3}, \frac{3}{4}, \cdots$</p>
                    </div>
                    <div style="background: rgba(14,165,233,0.08); padding: 16px; border-radius: 12px; border-left: 4px solid #0ea5e9;">
                        <h3>å‡½æ•°å†™æ³•</h3>
                        <p>$f(n),\\ n\in\mathbb{N}^+$</p>
                        <p>ä¾‹ï¼š$f(n)=\frac{n}{n+1}\Rightarrow f(1)=\frac{1}{2}, f(2)=\frac{2}{3}$</p>
                    </div>
                </div>
                <div class="teacher-note">â€œæ¢ä¸ªè§†è§’ï¼Œæ•°åˆ—å°±æ˜¯ä¸€ä¸ªåªåœ¨æ•´æ•°ç‚¹ä¸Šå–å€¼çš„ç¦»æ•£å‡½æ•°ã€‚â€</div>
                `,
                animation: "sequence_function"
            },
            {
                title: "å®šä¹‰åŸŸå†³å®šé€¼è¿‘æ–¹å¼",
                content: `
                    <h2>ğŸ›¤ï¸ å®šä¹‰åŸŸä¸åŒï¼Œé€¼è¿‘æ–¹å¼ä¹Ÿä¸åŒ</h2>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: rgba(251,191,36,0.12); padding: 16px; border-radius: 12px; border-left: 4px solid #fbbf24;">
                            <h3>æ•°åˆ—ï¼šç¦»æ•£çš„é“è·¯</h3>
                            <p>è‡ªå˜é‡åªèƒ½å– $1,2,3,\cdots$ï¼Œå”¯ä¸€çš„é€¼è¿‘æ–¹å¼æ˜¯ $n\to\infty$ã€‚</p>
                        </div>
                        <div style="background: rgba(34,197,94,0.12); padding: 16px; border-radius: 12px; border-left: 4px solid #22c55e;">
                            <h3>å‡½æ•°ï¼šè¿ç»­çš„é«˜é€Ÿå…¬è·¯</h3>
                            <p>è‡ªå˜é‡æ˜¯è¿ç»­å®æ•°ï¼Œå¯ä»¥å·¦é€¼è¿‘ã€å³é€¼è¿‘ã€è¶‹å‘ $+\infty$ æˆ– $-\infty$ã€‚</p>
                        </div>
                    </div>
                    <div class="prompt-card">
                        <strong>æ•™å¸ˆæé—®</strong>ï¼šâ€œå®šä¹‰åŸŸæ‰©å±•åï¼Œé€¼è¿‘æ–¹å¼ä¸ºä½•å˜å¤šï¼Ÿè¿™å°±æ˜¯å‡½æ•°æé™æ¯”æ•°åˆ—æé™å¤æ‚çš„åŸå› ã€‚â€
                    </div>
                `,
                animation: "domain_approach"
            },

            {
                title: "3. æé™å®šä¹‰ä¸é€šä¿—è§£é‡Š",
                content: `
                <h2>ğŸ¯ ç†è§£æé™çš„æœ¬è´¨</h2>
                <div class="prompt-card">
                    <strong>æ•™å¸ˆæé—®</strong>ï¼šåˆšæ‰æˆ‘ä»¬çœ‹åˆ°çš„'æ— é™æ¥è¿‘'ï¼Œåœ¨æ•°å­¦ä¸Šå°±å«'æé™'ã€‚è°èƒ½ç”¨è‡ªå·±çš„è¯æè¿°ä¸€ä¸‹ä»€ä¹ˆæ˜¯'æé™'ï¼Ÿå®ƒåƒä¸€ä¸ªæˆ‘ä»¬æ°¸è¿œä¹Ÿåˆ°ä¸äº†ï¼Œä½†å¯ä»¥æ— é™é è¿‘çš„ç›®æ ‡ã€‚
                </div>

                <div class="step-stack" id="limit-definition">
                    <div class="step-item active" data-step="1">
                        <h4>ğŸ¯ å°„ç®­ç±»æ¯”</h4>
                        <p><strong>é«˜æ‰‹å°„ç®­</strong>ï¼šç®­è¶Šæ¥è¶Šæ¥è¿‘é¶å¿ƒï¼Œä½†æ°¸è¿œæœ‰å¾®å°åå·®</p>
                        <h4>ğŸš— åœè½¦ç±»æ¯”</h4>
                        <p><strong>è‡ªåŠ¨æ³Šè½¦ç³»ç»Ÿ</strong>ï¼šè®©è½¦æ— é™æ¥è¿‘å®Œç¾ä½ç½®</p>
                        <button class="step-btn" data-action="next">ä¸‹ä¸€æ­¥ï¼šæ•°å­¦å®šä¹‰</button>
                    </div>

                    <div class="step-item" data-step="2">
                        <div class="definition">
                            <strong>å®šä¹‰2</strong> å¯¹äºæ•°åˆ— $\\{x_{n}\\}$,å¦‚æœå½“næ— é™å¢å¤§æ—¶,æ•°åˆ—çš„ä¸€èˆ¬é¡¹ $x_{n}$ æ— é™åœ°æ¥è¿‘äºæŸä¸€ç¡®å®šçš„æ•°å€¼a,åˆ™ç§°å¸¸æ•°aæ˜¯æ•°åˆ— $\\{x_{n}\\}$ çš„æé™,æˆ–ç§°æ•°åˆ— $\\{x_{n}\\}$ æ”¶æ•›äºa,è®°ä½œ $$\displaystyle\lim_{n\to\infty}x_{n}=a$$
                        </div>
                        <p>å¦‚æœæ•°åˆ—æ²¡æœ‰æé™,å°±è¯´æ•°åˆ—æ˜¯å‘æ•£çš„ã€‚</p>
                        <button class="step-btn" data-action="next">ä¸‹ä¸€æ­¥ï¼šÎµ-Næ‰¿è¯º</button>
                    </div>

                    <div class="step-item" data-step="3">
                        <h4>ğŸ“ Îµ-Næ‰¿è¯ºç†è§£</h4>
                        <p><strong>æ‰¿åŒ…å•†æ‰¿è¯º</strong>ï¼šå°±åƒæ‰¿åŒ…å•†è¯´"ç»™æˆ‘è¶³å¤Ÿæ—¶é—´(N)ï¼Œæˆ‘èƒ½æŠŠè¯¯å·®æ§åˆ¶åœ¨ä½ è¦æ±‚çš„èŒƒå›´(Îµ)å†…"</p>
                        <div class="teacher-note">
                            ä¹¦ä¸Šçš„ Îµ-N å®šä¹‰å…¶å®å°±æ˜¯åœ¨è¯´ï¼šæ— è®ºä½ è¦æ±‚å¤šå°çš„è¯¯å·®ï¼ˆÎµï¼‰ï¼Œæˆ‘æ€»èƒ½æ‰¾åˆ°ä¸€ä¸ªä½ç½®ï¼ˆNï¼‰ï¼Œä»è¿™ä¸ªä½ç½®å¾€åï¼Œæ‰€æœ‰çš„æ•°éƒ½æ»¡è¶³ä½ çš„è¯¯å·®è¦æ±‚ã€‚è¿™åƒä¸åƒä¸€ä¸ªæ‰¿è¯ºï¼Ÿ
                        </div>
                        <button class="step-btn completed" data-action="reset">é‡æ–°å¼€å§‹</button>
                    </div>
                </div>`,
                animation: "limit"
            },
            {
                title: "æé™çš„é€šä¿—ç†è§£",
                content: `<h4>æé™çš„é€šä¿—ç†è§£</h4><p><strong>æé™å°±æ˜¯ä¸€ä¸ª"ç›®æ ‡å€¼"æˆ–"é¶å¿ƒ"</strong>ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œæ•°åˆ—çš„æ¯ä¸€é¡¹ $x_n$ å°±åƒä¸€ä¸ªå°„æ‰‹åœ¨ä¸åŒæ—¶é—´ç‚¹ï¼ˆæ—¶é—´ç‚¹å°±æ˜¯nï¼‰å°„å‡ºçš„ä¸€æ”¯ç®­ã€‚</p><ul><li>å¦‚æœéšç€æ—¶é—´çš„æ¨ç§»ï¼ˆnè¶Šæ¥è¶Šå¤§ï¼‰ï¼Œè¿™äº›ç®­å°„å¾—<strong>è¶Šæ¥è¶Šé è¿‘ä¸€ä¸ªå›ºå®šçš„é¶å¿ƒ</strong>ï¼ˆæ•°å€¼aï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªé¶å¿ƒ"a"å°±æ˜¯è¿™ä¸ªæ•°åˆ—çš„<strong>æé™</strong>ã€‚</li><li>å¦‚æœè¿™äº›ç®­åˆ°å¤„ä¹±é£ï¼Œæ²¡æœ‰ä¸€ä¸ªæ˜ç¡®çš„é¶å¿ƒï¼Œé‚£å®ƒå°±æ²¡æœ‰æé™ã€‚</li></ul>`,
                animation: "target"
            },
            {
                title: "æ”¶æ•›ä¸å‘æ•£",
                content: `<h4>"æ”¶æ•›"ä¸"å‘æ•£"</h4><div class="definition"><strong>æ”¶æ•› (Convergent)</strong>ï¼šå°±æ˜¯æ•°åˆ—æœ‰æé™ã€‚æƒ³è±¡æ‰€æœ‰çš„é¡¹æœ€ç»ˆéƒ½"æ”¶"æ‹¢åˆ°æé™é‚£ä¸ªç‚¹é™„è¿‘ã€‚</div><div class="theorem"><strong>å‘æ•£ (Divergent)</strong>ï¼šå°±æ˜¯æ•°åˆ—æ²¡æœ‰æé™ã€‚å‘æ•£æœ‰ä¸¤ç§ä¸»è¦æƒ…å†µï¼š<ul><li>ä¸€ç§æ˜¯é¡¹çš„å€¼è¶Šæ¥è¶Šå¤§æˆ–è¶Šæ¥è¶Šå°ï¼Œå¥”å‘æ— ç©·äº†</li><li>å¦ä¸€ç§æ˜¯é¡¹çš„å€¼åœ¨å‡ ä¸ªæ•°ä¹‹é—´æ¥å›"éœ‡è¡"ï¼Œæ€»ä¹Ÿç¨³å®šä¸ä¸‹æ¥</li></ul></div>`,
                animation: "convergence"
            },
            {
                title: "CollatzçŒœæƒ³",
                content: `<h4>Collatz çŒœæƒ³ (3n+1 æ•°åˆ—)</h4><p>ä»ä»»ä½•æ­£æ•°å¼€å§‹å¹¶éµå¾ªä¸¤ä¸ªç®€å•è§„åˆ™ï¼š</p><ul><li>å¦‚æœ $x_{n}$ æ˜¯å¶æ•°,åˆ™ $x_{n+1}=\frac{x_{n}}{2}$</li><li>å¦‚æœ $x_{n}$ æ˜¯å¥‡æ•°,åˆ™ $x_{n+1}=3x_{n}+1$</li></ul><p>çŒœæƒ³è¡¨æ˜,æ— è®ºèµ·å§‹æ•°å­—å¦‚ä½•,æœ€ç»ˆæ€»ä¼šè¾¾åˆ°4, 2, 1çš„å¾ªç¯ã€‚</p>`,
                animation: "collatz"
            },
            {
                title: "æ–æ³¢é‚£å¥‘æ•°åˆ—",
                content: `<h4>æ–æ³¢é‚£å¥‘æ•°åˆ—ä¸é»„é‡‘åˆ†å‰²</h4><div class="example"><p><strong>æ–æ³¢é‚£å¥‘æ•°åˆ—</strong>: æ¯ä¸ªæ•°æ˜¯å‰ä¸¤ä¸ªæ•°çš„å’Œã€‚<br>0, 1, 1, 2, 3, 5, 8, 13, 21, 34,...</p><p><strong>é»„é‡‘åˆ†å‰² $\phi$</strong>: çº¦ç­‰äº1.618ã€‚</p><div class="formula-highlight">$$\displaystyle\lim_{n\to\infty}\frac{F(n)}{F(n-1)}=\phi$$</div></div>`,
                animation: "fibonacci"
            },
            {
                title: "ä¾‹1-1",
                content: `
                <div class="step-stack" data-steps="example1_1">
                  <div class="step-item active" data-step="1">
                    <h4>é¢˜é¢</h4>
                    <p>è®¨è®ºæ•°åˆ— $x_n=\frac{n}{n+1}$ çš„å˜åŒ–è¶‹åŠ¿</p>
                    <button class="step-btn" data-action="next">æ˜¾ç¤ºæ€è€ƒæç¤º</button>
                  </div>
                  <div class="step-item" data-step="2">
                    <h4>æ€è€ƒæç¤º</h4>
                    <p>ä»£å…¥ n=1,2,10,100ï¼Œè§‚å¯Ÿå€¼æ¥è¿‘å“ªä¸ªå¸¸æ•°ï¼Ÿ</p>
                    <button class="step-btn" data-action="next">æ˜¾ç¤ºè§£æ</button>
                  </div>
                  <div class="step-item" data-step="3">
                    <h4>è§£æ</h4>
                    <p>$\lim\limits_{n\to\infty}\frac{n}{n+1}=1$ï¼Œæ— é™æ¥è¿‘ä½†ä¸ç­‰äº 1ã€‚</p>
                  </div>
                </div>
                <div class="canvas-wrapper">
                  <canvas class="step-canvas" width="640" height="360" data-scene="example1_1"></canvas>
                </div>
                `,
                animation: "example1_1"
            },
            {
                title: "ä¾‹1-2",
                content: `
                <div class="step-stack" data-steps="example1_2">
                  <div class="step-item active" data-step="1">
                    <h4>é¢˜é¢</h4>
                    <p>æ•°åˆ— $x_{n}=\frac{1}{2}[1+(-1)^{n}]$ æ˜¯å¦æ”¶æ•›ï¼Ÿ</p>
                    <button class="step-btn" data-action="next">æ˜¾ç¤ºæ€è€ƒæç¤º</button>
                  </div>
                  <div class="step-item" data-step="2">
                    <h4>æ€è€ƒæç¤º</h4>
                    <p>å†™å‡ºå‰å‡ é¡¹å¹¶è§‚å¯Ÿæ˜¯å¦è¶‹äºå›ºå®šå€¼ï¼š$0,1,0,1,\cdots$</p>
                    <button class="step-btn" data-action="next">æ˜¾ç¤ºè§£æ</button>
                  </div>
                  <div class="step-item" data-step="3">
                    <h4>è§£æ</h4>
                    <p>åœ¨ 0 ä¸ 1 ä¹‹é—´éœ‡è¡ä¸è¶‹äºå¸¸æ•°ï¼Œæ•…æé™ä¸å­˜åœ¨ï¼ˆå‘æ•£ï¼‰ã€‚</p>
                  </div>
                </div>
                <div class="canvas-wrapper">
                  <canvas class="step-canvas" width="640" height="360" data-scene="example1_2"></canvas>
                </div>
                `,
                animation: "example1_2"
            },
            {
                title: "ä¾‹1-3",
                content: `
                <div class="step-stack" data-steps="example1_3">
                  <div class="step-item active" data-step="1">
                    <h4>é¢˜é¢</h4>
                    <p>è®¨è®º $x_{n}=\frac{1}{(-3)^{n}}$ çš„æ”¶æ•›æ€§</p>
                    <button class="step-btn" data-action="next">æ˜¾ç¤ºæ€è€ƒæç¤º</button>
                  </div>
                  <div class="step-item" data-step="2">
                    <h4>æ€è€ƒæç¤º</h4>
                    <p>$|x_n|=3^{-n}$ï¼Œéš n å¢å¤§è¿…é€Ÿè¶‹äº 0</p>
                    <button class="step-btn" data-action="next">æ˜¾ç¤ºè§£æ</button>
                  </div>
                  <div class="step-item" data-step="3">
                    <h4>è§£æ</h4>
                    <p>$\lim\limits_{n\to\infty} x_n = 0$ï¼Œæ”¶æ•›åˆ° 0ï¼ˆç¬¦å·äº¤æ›¿ä½†å¹…åº¦è¡°å‡ï¼‰ã€‚</p>
                  </div>
                </div>
                <div class="canvas-wrapper">
                  <canvas class="step-canvas" width="640" height="360" data-scene="example1_3"></canvas>
                </div>
                `,
                animation: "example1_3"
            },
            {
                title: "ä¾‹1-4",
                content: `
                <div class="step-stack" data-steps="example1_4">
                  <div class="step-item active" data-step="1">
                    <h4>é¢˜é¢</h4>
                    <p>å¸¸æ•°æ•°åˆ— $x_n=8$ çš„æé™æ˜¯ä»€ä¹ˆï¼Ÿ</p>
                    <button class="step-btn" data-action="next">æ˜¾ç¤ºæ€è€ƒæç¤º</button>
                  </div>
                  <div class="step-item" data-step="2">
                    <h4>æ€è€ƒæç¤º</h4>
                    <p>æ¯ä¸€é¡¹éƒ½ç­‰äºåŒä¸€ä¸ªå¸¸æ•°ï¼Œæ˜¯å¦å­˜åœ¨â€œé è¿‘â€çš„ç›®æ ‡ï¼Ÿ</p>
                    <button class="step-btn" data-action="next">æ˜¾ç¤ºè§£æ</button>
                  </div>
                  <div class="step-item" data-step="3">
                    <h4>è§£æ</h4>
                    <p>$\lim\limits_{n\to\infty} 8 = 8$ï¼Œå¸¸æ•°åˆ—çš„æé™å³è¯¥å¸¸æ•°ã€‚</p>
                  </div>
                </div>
                <div class="canvas-wrapper">
                  <canvas class="step-canvas" width="640" height="360" data-scene="example1_4"></canvas>
                </div>
                `,
                animation: "example1_4"
            },
            {
            title: "æ‹“å±•æ¡ˆä¾‹ï¼šCollatz çŒœæƒ³",
                content: `
                <h2>ğŸ” æ‹“å±•æ¡ˆä¾‹ï¼šCollatz çŒœæƒ³</h2>
                <p>ä»»æ„æ­£æ•´æ•°æŒ‰â€œå¥‡æ•°ä¹˜3åŠ 1ã€å¶æ•°é™¤ä»¥2â€çš„è§„åˆ™æ¼”åŒ–ï¼Œä¼¼ä¹éƒ½ä¼šå›åˆ° $1 \rightarrow 4 \rightarrow 2 \rightarrow 1$ çš„å¾ªç¯ã€‚</p>
                <div class="note">æœªè¢«è¯æ˜çš„å¼€æ”¾é—®é¢˜ï¼šæ‰€æœ‰èµ·ç‚¹æ˜¯å¦éƒ½æœ€ç»ˆè¿›å…¥è¯¥å¾ªç¯ï¼Ÿ</div>
                `,
                animation: "collatz"
            },
            {
                title: "æ‹“å±•æ¡ˆä¾‹ï¼šæ–æ³¢é‚£å¥‘ä¸é»„é‡‘åˆ†å‰²",
                content: `
                <h2>ğŸ“ æ–æ³¢é‚£å¥‘æ•°åˆ—ä¸é»„é‡‘åˆ†å‰²</h2>
                <p>æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼š$0,1,1,2,3,5,8,\cdots$</p>
                <p>æ¯”å€¼æé™ï¼š$\displaystyle\lim_{n\to\infty}\frac{F_n}{F_{n-1}}=\Phi\approx1.618$</p>
                <div class="teacher-note">è¿™ä¸ªæé™è§£é‡Šäº†è‡ªç„¶ç•Œä¸è‰ºæœ¯ä¸­åå¤å‡ºç°çš„é»„é‡‘æ¯”ä¾‹ã€‚</div>
                `,
                animation: "fibonacci"
            },
            {
                title: "æ‹“å±•æ¡ˆä¾‹ï¼šæŠ˜æ—§æ¨¡å‹",
                content: `
                <h2>ğŸ’¼ æŠ˜æ—§æ¨¡å‹ï¼šç°å®ä¸­çš„æ”¶æ•›</h2>
                <p>ä¾‹ï¼šä¸€å°è®¾å¤‡æ¯å¹´æŠ˜æ—§ 10%ï¼Œä»·æ ¼æ¨¡å‹ $V_n = V_0 (0.9)^{n}$ã€‚</p>
                <p>éšç€ $n \to \infty$ï¼Œ$V_n \to 0$ï¼Œè¯´æ˜å®é™…ä»·å€¼å°†æ— é™æ¥è¿‘æ®‹å€¼ã€‚</p>
                `,
                animation: "depreciation"
            },            {
                title: "å‡½æ•°çš„æé™ï¼šæ•´ä½“è§†è§’",
                content: `<h3>2.1.2 å‡½æ•°çš„æé™</h3><p>è‡ªå˜é‡å¯ä»¥ä¸é™äºæ•´æ•°ï¼Œæˆ‘ä»¬å…³æ³¨çš„æ˜¯å‡½æ•°å€¼åœ¨ä¸åŒè¶‹è¿‘æ–¹å¼ä¸‹çš„è¡¨ç°ã€‚</p><div class="teacher-note">â€œå‡½æ•°æé™â€æ˜¯æŠŠæ•°åˆ—æé™æ¨å¹¿åˆ°è¿ç»­è‡ªå˜é‡çš„ç¬¬ä¸€æ­¥ã€‚</div>`,
                animation: "function_notation"
            },
            {
                title: "å‡½æ•°çš„æé™ï¼šx â†’ âˆ",
                content: `<h3>$x \to \infty$ï¼ˆè¶‹å‘æ— ç©·ï¼‰</h3><ul><li><strong>å«ä¹‰ï¼š</strong>$x$ çš„ç»å¯¹å€¼æ— é™å¢å¤§</li><li><strong>è®°å·ï¼š</strong>$\displaystyle\lim_{x\to\infty}f(x)=L$</li><li><strong>å‡ ä½•æ„ä¹‰ï¼š</strong>æ²¿æ•°è½´å‘ä¸¤ç«¯ç§»åŠ¨æ—¶ï¼Œå‡½æ•°å€¼è¶Šæ¥è¶Šæ¥è¿‘ $L$ã€‚</li></ul>`,
                animation: "function_infinity"
            },
            {
                title: "å‡½æ•°çš„æé™ï¼šx â†’ +âˆ",
                content: `<h3>$x \to +\infty$ï¼ˆè¶‹å‘æ­£æ— ç©·ï¼‰</h3><ul><li><strong>å«ä¹‰ï¼š</strong>$x$ å–è¶Šæ¥è¶Šå¤§çš„æ­£æ•°</li><li><strong>è®°å·ï¼š</strong>$\displaystyle\lim_{x\to+\infty}f(x)=L$</li><li><strong>å‡ ä½•æ„ä¹‰ï¼š</strong>æ²¿æ•°è½´å³ç«¯å‰è¿›æ—¶ï¼Œå‡½æ•°å€¼é€¼è¿‘ $L$ã€‚</li></ul>`,
                animation: "function_infinity"
            },
            {
                title: "å‡½æ•°çš„æé™ï¼šx â†’ -âˆ",
                content: `<h3>$x \to -\infty$ï¼ˆè¶‹å‘è´Ÿæ— ç©·ï¼‰</h3><ul><li><strong>å«ä¹‰ï¼š</strong>$x$ å–è¶Šæ¥è¶Šå°çš„è´Ÿæ•°</li><li><strong>è®°å·ï¼š</strong>$\displaystyle\lim_{x\to-\infty}f(x)=L$</li><li><strong>å‡ ä½•æ„ä¹‰ï¼š</strong>æ²¿æ•°è½´å·¦ç«¯å‰è¿›æ—¶ï¼Œå‡½æ•°å€¼é€¼è¿‘ $L$ã€‚</li></ul>`,
                animation: "function_infinity"
            },
            {
                title: "å‡½æ•°çš„æé™ï¼šx â†’ xâ‚€",
                content: `<h3>$x \to x_0$ï¼ˆè¶‹å‘æŸä¸ªç‚¹ï¼‰</h3><ul><li><strong>å«ä¹‰ï¼š</strong>$x$ å¯ä»¥ä»å·¦å³ä¸¤è¾¹æ— é™é è¿‘ $x_0$ã€‚</li><li><strong>è®°å·ï¼š</strong>$\displaystyle\lim_{x\to x_0}f(x)=L$</li><li><strong>å‡ ä½•æ„ä¹‰ï¼š</strong>åœ¨ç‚¹ $x_0$ é™„è¿‘è§‚å¯Ÿå‡½æ•°çš„å±€éƒ¨è¡Œä¸ºã€‚</li></ul>`,
                animation: "point_limit"
            },
            {
                title: "å‡½æ•°çš„å³æé™ï¼šx â†’ xâ‚€âº",
                content: `<h3>$x \to x_0^+$ï¼ˆä»å³ä¾§é€¼è¿‘ï¼‰</h3><ul><li><strong>å«ä¹‰ï¼š</strong>$x$ å–å¤§äº $x_0$ çš„å€¼å¹¶é€æ¸æ¥è¿‘å®ƒã€‚</li><li><strong>è®°å·ï¼š</strong>$\displaystyle\lim_{x\to x_0^+}f(x)=L$</li><li><strong>ç†è§£ï¼š</strong>åªæ²¿æ•°è½´å³ä¾§é è¿‘ç›®æ ‡ç‚¹ã€‚</li></ul>`,
                animation: "right_limit_viz"
            },
            {
                title: "å‡½æ•°çš„å·¦æé™ï¼šx â†’ xâ‚€â»",
                content: `<h3>$x \to x_0^-$ï¼ˆä»å·¦ä¾§é€¼è¿‘ï¼‰</h3><ul><li><strong>å«ä¹‰ï¼š</strong>$x$ å–å°äº $x_0$ çš„å€¼å¹¶é€æ¸æ¥è¿‘å®ƒã€‚</li><li><strong>è®°å·ï¼š</strong>$\displaystyle\lim_{x\to x_0^-}f(x)=L$</li><li><strong>ç†è§£ï¼š</strong>åªæ²¿æ•°è½´å·¦ä¾§é è¿‘ç›®æ ‡ç‚¹ã€‚</li></ul>`,
                animation: "left_limit_viz"
            },
            {
                title: "å‡½æ•°çš„æé™é€šä¿—ç†è§£",
                content: `<h4>å‡½æ•°æé™çš„é€šä¿—ç†è§£</h4><div class="note"><p><strong>å½“ $x \to \infty$ æ—¶ï¼š</strong><br>å¥½æ¯”ä½ ç«™åœ¨å‡½æ•°å›¾åƒä¸Šï¼Œæ²¿ç€xè½´ä¸€ç›´å‘å³($x \to +\infty$)æˆ–å‘å·¦($x \to -\infty$)èµ°ã€‚æˆ‘ä»¬å…³å¿ƒçš„æ˜¯ï¼Œå½“ä½ èµ°å¾—éå¸¸è¿œæ—¶ï¼Œä½ æ‰€åœ¨ä½ç½®çš„é«˜åº¦(yå€¼)æ˜¯å¦ä¼šç¨³å®šåœ¨æŸä¸€ä¸ªå€¼ï¼Ÿ</p><p><strong>å½“ $x \to x_0$ æ—¶ï¼š</strong><br>æˆ‘ä»¬å…³å¿ƒx<strong>æ— é™é è¿‘</strong> $x_0$ æ—¶å‡½æ•°çš„é«˜åº¦ $f(x)$ ä¼šæ€æ ·ã€‚<strong>åªå…³å¿ƒ $x_0$ ç‚¹é™„è¿‘çš„è¶‹åŠ¿ï¼Œä¸åœ¨ä¹å‡½æ•°åœ¨ $x_0$ ç‚¹æœ¬èº«çš„å€¼ï¼</strong></p></div>`,
                animation: "function_limit_concept"
            },
            {
                title: "å®ä¾‹1 åŠ¨ç‰©æ•°é‡",
                content: `<div class="example"><strong>å®ä¾‹1 è‡ªç„¶ä¿æŠ¤åŒºä¸­åŠ¨ç‰©æ•°é‡çš„å˜åŒ–è§„å¾‹</strong><br>åŠ¨ç‰©ç¾¤ä½“æ•°é‡ä¼šé€æ¸å¢é•¿ï¼Œä½†ç”±äºèµ„æºé™åˆ¶ï¼Œç¾¤ä½“ä¸å¯èƒ½æ— é™å¢å¤§ï¼Œå®ƒåº”è¾¾åˆ°æŸä¸€é¥±å’ŒçŠ¶æ€ã€‚é¥±å’ŒçŠ¶æ€å°±æ˜¯æ—¶é—´ $t \to \infty$ æ—¶åŠ¨ç‰©ç¾¤çš„æ•°é‡ã€‚</div>`,
                animation: "population"
            },
            {
                title: "$x \to \infty$ æ—¶æé™å®šä¹‰",
                content: `<div class="definition"><strong>å®šä¹‰3</strong> å¦‚æœå½“ $x\to\infty$ æ—¶,å‡½æ•°å€¼ $f(x)$ æ— é™è¶‹è¿‘äºæŸä¸€ä¸ªç¡®å®šçš„å¸¸æ•°A,é‚£ä¹ˆAå°±ç§°ä¸ºå‡½æ•° $f(x)$ å½“ $x\to\infty$ æ—¶çš„æé™,è®°ä½œ $$\displaystyle\lim_{x\to\infty}f(x)=A$$</div><div class="theorem"><strong>å®šç†1</strong> $$\displaystyle\lim_{x\to\infty}f(x)=A \iff \lim_{x\to+\infty}f(x)=\lim_{x\to-\infty}f(x)=A$$</div>`,
                animation: "function_infinity"
            },
            {
                title: "ä¾‹3 y=1/x",
                content: `<div class="example"><strong>ä¾‹3</strong> è®¨è®ºå½“ $x\to+\infty$ æ—¶,å‡½æ•° $y=\frac{1}{x}$ çš„å˜åŒ–è¶‹åŠ¿ã€‚</div><p><strong>è§£</strong>: å½“xæ²¿xè½´æ­£æ–¹å‘æ— é™å¢å¤§æ—¶,æ›²çº¿ $y=\frac{1}{x}$ æ— é™æ¥è¿‘äºxè½´,æ•…æé™ä¸º0ã€‚</p><div class="formula-highlight">$$\displaystyle\lim_{x\to+\infty}\frac{1}{x}=0$$</div>`,
                animation: "one_over_x"
            },
            {
                title: "ä¾‹4 åæ­£åˆ‡å‡½æ•°",
                content: `<div class="example"><strong>ä¾‹4</strong> è®¨è®ºåæ­£åˆ‡å‡½æ•° $y=\arctan x$ çš„æé™ã€‚</div><p><strong>è§£</strong>: $$\displaystyle\lim_{x\to+\infty}\arctan x=\frac{\pi}{2}$$ $$\displaystyle\lim_{x\to-\infty}\arctan x=-\frac{\pi}{2}$$</p><p>ç”±äºå·¦å³æé™ä¸ç›¸ç­‰, æ‰€ä»¥ $\displaystyle\lim_{x\to\infty}\arctan x$ ä¸å­˜åœ¨ã€‚</p>`,
                animation: "arctan"
            },
            {
                title: "xè¶‹å‘x0æ—¶çš„æé™",
                content: `<h4>2. å½“ $x\to x_{0}$ æ—¶,å‡½æ•° $f(x)$ çš„æé™</h4><div class="example"><strong>å®ä¾‹4 äººå½±é•¿åº¦</strong><br>è‹¥ä¸€ä¸ªäººèµ°å‘è·¯ç¯æ­£ä¸‹æ–¹,ä»–è¶Šé è¿‘ç›®æ ‡ $(x \to 0)$,å…¶å½±å­é•¿åº¦è¶ŠçŸ­,é€æ¸è¶‹äº $0(y \to 0)$ã€‚</div>`,
                animation: "shadow"
            },
            {
                title: "å‡½æ•°åœ¨ç‚¹çš„æé™å®šä¹‰",
                content: `<div class="definition"><strong>å®šä¹‰2-3</strong> å¦‚æœå½“ $x \to x_0$ æ—¶, å‡½æ•° $f(x)$ æ— é™æ¥è¿‘äºä¸€ä¸ªç¡®å®šçš„å¸¸æ•°A, é‚£ä¹ˆç§°Aä¸ºå‡½æ•° $f(x)$ åœ¨ $x \to x_0$ æ—¶çš„æé™, è®°ä¸º $$\displaystyle\lim_{x \to x_0} f(x) = A$$</div>`,
                animation: "point_limit"
            },
            {
                title: "ç¬æ—¶é€Ÿåº¦",
                content: `<div class="example"><strong>å®ä¾‹5 ç¬æ—¶é€Ÿåº¦</strong><br>è‡ªç”±è½ä½“è¿åŠ¨çš„è·¯ç¨‹å‡½æ•°ä¸º $s = \frac{1}{2}gt^2$ã€‚$t_0$ æ—¶åˆ»çš„ç¬æ—¶é€Ÿåº¦å°±æ˜¯ $t_0$ åˆ° $t$ çš„å¹³å‡é€Ÿåº¦åœ¨ $t \to t_0$ æ—¶çš„æé™ã€‚</div><p>$$v(t_0) = \displaystyle\lim_{t \to t_0} \frac{s(t) - s(t_0)}{t - t_0} = gt_0$$</p>`,
                animation: "velocity"
            },
            {
                title: "ä¾‹6",
                content: `<div class="example"><strong>ä¾‹6</strong> è®¾ $f(x)=\begin{cases}x+2, & x\geq 1 \\ 3x, & x<1\end{cases}$,åˆ¤æ–­ $\displaystyle\lim_{x\to 1}f(x)$ æ˜¯å¦å­˜åœ¨ã€‚</div><p><strong>è§£</strong>: $\displaystyle\lim_{x\to 1^{+}}f(x)=\lim_{x\to 1^{+}}(x+2)=3$</p><p>$\displaystyle\lim_{x\to 1^{-}}f(x)=\lim_{x\to 1^{-}}3x=3$</p><p>å·¦å³æé™å­˜åœ¨ä¸”ç›¸ç­‰, æ‰€ä»¥ $\displaystyle\lim_{x\to 1}f(x)=3$ã€‚</p>`,
                animation: "piecewise1"
            },
            {
                title: "ä¾‹7",
                content: `<div class="example"><strong>ä¾‹7</strong> è®¾ $f(x)=\begin{cases}x^{2}, & x\geq 0 \\ x+1, & x<0\end{cases}$ è®¨è®º $\displaystyle\lim_{x\to 0}f(x)$ æ˜¯å¦å­˜åœ¨?</div><p><strong>è§£</strong>: $\displaystyle\lim_{x\to 0^{-}}f(x)=\lim_{x\to 0^{-}}(x+1)=1$</p><p>$\displaystyle\lim_{x\to 0^{+}}f(x)=\lim_{x\to 0^{+}}x^{2}=0$</p><p>å·¦å³æé™ä¸ç›¸ç­‰, æ‰€ä»¥ $\displaystyle\lim_{x\to 0}f(x)$ ä¸å­˜åœ¨ã€‚</p>`,
                animation: "piecewise2"
            },
            {
                title: "æ— ç©·å°é‡",
                content: `<h3>2.1.3 æ— ç©·å°é‡ä¸æ— ç©·å¤§é‡</h3><h4>1. æ— ç©·å°é‡</h4><div class="definition"><strong>å®šä¹‰5</strong> åœ¨è‡ªå˜é‡xçš„æŸä¸€å˜åŒ–è¿‡ç¨‹ä¸­,è‹¥å‡½æ•° $f(x)$ çš„æé™ä¸º0,å³ $\lim f(x)=0$,åˆ™ç§° $f(x)$ ä¸ºåœ¨è¯¥å˜åŒ–è¿‡ç¨‹ä¸­çš„<strong>æ— ç©·å°é‡</strong>ã€‚</div><div class="note"><strong>æ³¨æ„</strong>ï¼šæ— ç©·å°ä¸æ˜¯ä¸€ä¸ª"å¾ˆå°çš„æ•°"ï¼Œè€Œæ˜¯ä¸€ä¸ªä»¥é›¶ä¸ºæé™çš„å‡½æ•°ã€‚</div>`,
                animation: "infinitesimal"
            },
            {
                title: "æ— ç©·å°çš„æ€§è´¨",
                content: `<h4>æ— ç©·å°çš„æ€§è´¨</h4><div class="theorem"><strong>æ€§è´¨1</strong> æœ‰é™ä¸ªæ— ç©·å°çš„ä»£æ•°å’Œä»æ˜¯æ— ç©·å°ã€‚<br><strong>æ€§è´¨2</strong> æœ‰é™ä¸ªæ— ç©·å°çš„ä¹˜ç§¯ä»æ˜¯æ— ç©·å°ã€‚<br><strong>æ€§è´¨3</strong> æœ‰ç•Œå‡½æ•°ä¸æ— ç©·å°çš„ä¹˜ç§¯ä»æ˜¯æ— ç©·å°ã€‚</div><div class="example"><strong>ä¾‹8</strong> æ±‚ $\\displaystyle\\lim_{x\\to\\infty}\\frac{1}{x}\\cos x$ ã€‚<br><strong>è§£</strong>: $\\frac{1}{x}$ æ˜¯æ— ç©·å°, $|\\cos x|\\geq 1$ æ˜¯æœ‰ç•Œå‡½æ•°, æ•…æé™ä¸º0ã€‚</div>`,
                animation: "infinitesimal_prop"
            },            {
                title: "æ— ç©·å¤§é‡ï¼šæ¦‚å¿µ",
                content: `<h3>æ— ç©·å¤§é‡çš„å®šä¹‰</h3><p>åœ¨æŸä¸ªå˜åŒ–è¿‡ç¨‹ä¸­ï¼Œè‹¥ $|f(x)|$ æ— é™å¢å¤§ï¼Œåˆ™ç§° $f(x)$ ä¸º<strong>æ— ç©·å¤§é‡</strong>ï¼Œè®°ä½œ $\displaystyle\lim f(x)=\infty$ã€‚</p><div class="visual-hint">ğŸ“ˆ æƒ³è±¡å‡½æ•°å€¼è¶Šèµ°è¶Šè¿œï¼Œæ²¡æœ‰ä¸Šç•Œã€‚</div>`,
                animation: "infinite"
            },
            {
                title: "æ— ç©·å¤§é‡ï¼šåˆ†ç±»",
                content: `<h3>å¸¸è§ä¸‰ç§æƒ…å½¢</h3><ul><li><strong>æ­£æ— ç©·ï¼š</strong>$f(x)\to +\infty$</li><li><strong>è´Ÿæ— ç©·ï¼š</strong>$f(x)\to -\infty$</li><li><strong>æ— ç©·ï¼š</strong>$|f(x)|\to \infty$ ä¸åŒºåˆ†æ­£è´Ÿã€‚</li></ul>`,
                animation: "infinite"
            },
            {
                title: "æ— ç©·å¤§é‡ï¼šä¸æ— ç©·å°çš„å…³ç³»",
                content: `<h3>äº’ä¸ºå€’æ•°</h3><p>è‹¥ $\alpha\to 0$ï¼Œåˆ™ $\frac{1}{\alpha}\to \infty$ï¼›åä¹‹äº¦ç„¶ã€‚æ— ç©·å¤§å’Œæ— ç©·å°æ˜¯ä¸€å¯¹â€œé•œåƒâ€æ¦‚å¿µã€‚</p>`,
                animation: "infinitesimal_compare"
            },
            {
                title: "æ— ç©·å¤§é‡ï¼šå…¸å‹ä¾‹å­",
                content: `<h3>ä¸‰ç±»å¸¸è§ä¾‹å­</h3><ul><li>$\displaystyle\frac{1}{x}$ å½“ $x\to 0$ã€‚</li><li>$e^x$ å½“ $x\to +\infty$ã€‚</li><li>$\tan x$ å½“ $x\to \frac{\pi}{2}$ã€‚</li></ul>`,
                animation: "infinite"
            },
            {
                title: "æé™çš„æ€§è´¨",
                content: `<h2>2.2 æé™çš„æ€§è´¨å’Œè¿ç®—æ³•åˆ™</h2><h3>2.2.1 æé™çš„æ€§è´¨</h3><div class="theorem"><p><strong>å®šç†1ï¼ˆå”¯ä¸€æ€§ï¼‰</strong> å¦‚æœæé™å­˜åœ¨,åˆ™æé™å”¯ä¸€ã€‚</p><p><strong>å®šç†2ï¼ˆæœ‰ç•Œæ€§ï¼‰</strong> å¦‚æœæé™å­˜åœ¨,åˆ™åœ¨æŸé‚»åŸŸå†…æœ‰ç•Œã€‚</p><p><strong>å®šç†3ï¼ˆä¿å·æ€§ï¼‰</strong> å¦‚æœå‡½æ•°å€¼ $\geq 0$,åˆ™æé™ä¹Ÿ $\geq 0$ã€‚</p></div>`,
                animation: "limit_properties"
            },
            {
                title: "æé™çš„è¿ç®—æ³•åˆ™",
                content: `<h3>2.2.2 æé™çš„è¿ç®—æ³•åˆ™</h3><div class="theorem"><strong>å®šç†4</strong> è®¾ $\lim f(x)=A$ , $\lim g(x)=B$ ,åˆ™<ol><li>$\lim [f(x)\pm g(x)]=A\pm B$</li><li>$\lim [f(x)\cdot g(x)]=A\cdot B$</li><li>$\lim \frac{f(x)}{g(x)}=\frac{A}{B}(B\geq 0)$</li></ol></div>`,
                animation: "limit_rules"
            },
            {
                title: "ç›´æ¥ä»£å…¥æ³•",
                content: `<h3>2.2.3 æé™çš„æ±‚æ³•</h3><h4>1. ç›´æ¥ä»£å…¥æ³•</h4><div class="example"><strong>ä¾‹1</strong> æ±‚ $\displaystyle\lim_{x \to 1} \frac{3x^2 + x + 1}{4x^3 + x^2 - x + 3}$<br><strong>è§£</strong>: $\frac{3(1)^2 + 1 + 1}{4(1)^3 + 1^2 - 1 + 3} = \frac{5}{7}$</div>`,
                animation: "direct_sub"
            },
            {
                title: "0/0å‹æé™",
                content: `<h4>3. åˆ†è§£å› å¼,çº¦å»é›¶å› å­æ³•ï¼ˆ$\frac{0}{0}$ å‹ï¼‰</h4><p>$\frac{0}{0}$ å‹æé™è¢«ç§°ä¸º"æœªå®šå¼"ã€‚å®ƒå°±åƒä¸€åœºæ‹”æ²³æ¯”èµ›,åˆ†å­æƒ³æŠŠç»“æœæ‹‰å‘0,åˆ†æ¯æƒ³æŠŠç»“æœæ‹‰å‘æ— ç©·å¤§ã€‚æ–¹æ³•ï¼šå°†åˆ†å­æˆ–åˆ†æ¯åˆ†è§£å› å¼,<strong>çº¦å»å…±åŒçš„é›¶å› å­</strong>,å†ç”¨ç›´æ¥ä»£å…¥æ³•ã€‚</p>`,
                animation: "zero_zero"
            },
            {
                title: "æœ‰ç†åŒ–",
                content: `<h4>4. åˆ†å­æˆ–åˆ†æ¯æœ‰ç†åŒ–ï¼ˆ$\frac{0}{0}$ å‹ï¼‰</h4><div class="example"><strong>ä¾‹3</strong> æ±‚ $\displaystyle\lim_{x \to 4} \frac{x-4}{\sqrt{x-2}-\sqrt{2}}$<br><strong>è§£</strong>: $$\displaystyle\lim_{x \to 4} \frac{(x-4)(\sqrt{x-2}+\sqrt{2})}{(\sqrt{x-2}-\sqrt{2})(\sqrt{x-2}+\sqrt{2})} = \lim_{x \to 4} (\sqrt{x-2}+\sqrt{2}) = 2\sqrt{2}$$</div>`,
                animation: "rationalize"
            },
            {
                title: "æ— ç©·/æ— ç©·å‹",
                content: `<h4>5. å…¬å¼æ³•ï¼ˆ$\frac{\infty}{\infty}$ å‹ï¼‰</h4><div class="formula-highlight">$$\displaystyle\lim_{x\to\infty}\frac{a_{0}x^{n}+\cdots}{b_{0}x^{m}+\cdots}=\begin{cases} \frac{a_{0}}{b_{0}}, & n=m \\ 0, & n<m \\ \infty, & n>m \end{cases}$$</div><p>æé™çš„ç»“æœ,å–å†³äºåˆ†å­å’Œåˆ†æ¯ä¸­"è·‘å¾—æœ€å¿«çš„é‚£ä¸ªé¢†å¤´é¡¹"ã€‚</p>`,
                animation: "infinity_infinity"
            },
            {
                title: "ç¬¬ä¸€ä¸ªé‡è¦æé™",
                content: `<h2>2.3 ä¸¤ä¸ªé‡è¦æé™åŠæ— ç©·å°çš„æ¯”è¾ƒ</h2><h3>2.3.1 ä¸¤ä¸ªé‡è¦æé™</h3><h4>ç¬¬ä¸€ä¸ªé‡è¦æé™</h4><div class="formula-highlight">$$\displaystyle\lim_{x\to 0}\frac{\sin x}{x}=1$$</div><p>å®ƒæ­ç¤ºäº†ï¼š<strong>å½“è§’åº¦xéå¸¸å°æ—¶, $\sin(x)$ çš„å€¼å’Œ $x$ çš„å€¼å‡ ä¹æ˜¯ä¸€æ ·çš„</strong> (xä¸ºå¼§åº¦åˆ¶)ã€‚</p>`,
                animation: "sinx_x"
            },
            {
                title: "ç¬¬äºŒä¸ªé‡è¦æé™",
                content: `<h4>ç¬¬äºŒä¸ªé‡è¦æé™</h4><div class="formula-highlight">$$\displaystyle\lim_{x\to\infty}\left(1+\frac{1}{x}\right)^{x}=e$$</div><p>å®ƒå®šä¹‰äº†è‡ªç„¶å¸¸æ•° <strong>e (â‰ˆ2.718)</strong>, å…¶èƒŒæ™¯æ˜¯<strong>é“¶è¡Œçš„è¿ç»­å¤åˆ©</strong>ã€‚å¦‚æœè®¡æ¯æ¬¡æ•°æ— é™å¢å¤š,æœ€ç»ˆå¾—åˆ°çš„é’±ä¼šè¶‹å‘äºæé™å€¼eã€‚</p>`,
                animation: "e_limit"
            },
            {
                title: "æ— ç©·å°æ¯”è¾ƒï¼šå…¨å±€è§†å›¾",
                content: `<h3>2.3.2 æ— ç©·å°çš„æ¯”è¾ƒ</h3>
                <p>è®¾ $\alpha, \beta$ æ˜¯æ— ç©·å°é‡ï¼Œé€šè¿‡æ¯”è¾ƒ $\displaystyle\lim\frac{\beta}{\alpha}$ çš„å€¼æ¥åˆ¤æ–­è°â€œè·‘å¾—æ›´å¿«â€ã€‚</p>
                <div style="display: grid; gap: 12px; margin: 20px 0;">
                    <div style="background: rgba(52, 152, 219, 0.1); padding: 12px; border-radius: 8px; border-left: 4px solid #3498db;">
                        <strong>é«˜é˜¶æ— ç©·å°ï¼š</strong>$\displaystyle\lim\frac{\beta}{\alpha}=0$ â†’ $\beta$ æ¯” $\alpha$ â€œå°å¾—æ›´å¿«â€
                    </div>
                    <div style="background: rgba(231, 76, 60, 0.1); padding: 12px; border-radius: 8px; border-left: 4px solid #e74c3c;">
                        <strong>ä½é˜¶æ— ç©·å°ï¼š</strong>$\displaystyle\lim\frac{\beta}{\alpha}=\infty$ â†’ $\beta$ æ¯” $\alpha$ â€œå°å¾—æ›´æ…¢â€
                    </div>
                    <div style="background: rgba(155, 89, 182, 0.1); padding: 12px; border-radius: 8px; border-left: 4px solid #9b59b6;">
                        <strong>åŒé˜¶æ— ç©·å°ï¼š</strong>$\displaystyle\lim\frac{\beta}{\alpha}=c\neq0$ â†’ $\beta$ ä¸ $\alpha$ â€œå°å¾—ä¸€æ ·å¿«â€
                    </div>
                    <div style="background: rgba(46, 204, 113, 0.1); padding: 12px; border-radius: 8px; border-left: 4px solid #2ecc71;">
                        <strong>ç­‰ä»·æ— ç©·å°ï¼š</strong>$\displaystyle\lim\frac{\beta}{\alpha}=1$ â†’ $\beta$ ä¸ $\alpha$ â€œå‡ ä¹ç›¸ç­‰â€ï¼Œè®°ä½œ $\alpha\sim\beta$
                    </div>
                </div>
                <div class="visual-hint">ğŸƒâ€â™‚ï¸ å››ç§â€œè·‘å‘ 0â€ çš„èŠ‚å¥ï¼Œå†³å®šæˆ‘ä»¬å¦‚ä½•æ¯”è¾ƒæ— ç©·å°ã€‚</div>`,
                animation: "infinitesimal_compare"
            },
            {
                title: "é«˜é˜¶æ— ç©·å°",
                content: `<h3>é«˜é˜¶æ— ç©·å°ï¼šæ‰å¾—æ›´å¿«</h3>
                <div class="definition" style="background: rgba(52, 152, 219, 0.1); padding: 20px; border-radius: 10px; border-left: 4px solid #3498db;">
                    <p><strong>å®šä¹‰ï¼š</strong>è‹¥ $\displaystyle\lim\frac{\beta}{\alpha}=0$ï¼Œåˆ™ $\beta = o(\alpha)$ï¼Œå³ $\beta$ æ¯” $\alpha$ â€œå°å¾—æ›´å¿«â€ã€‚</p>
                </div>
                <div style="margin: 20px 0;">
                    <h4>ğŸ“ å…¸å‹ä¾‹å­</h4>
                    <div style="background: rgba(255, 255, 255, 0.75); padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                        <p><strong>ä¾‹1ï¼š</strong>å½“ $x \to 0$ï¼Œ$\displaystyle\frac{x^2}{x} \to 0$ï¼Œå› æ­¤ $x^2$ æ˜¯ $x$ çš„é«˜é˜¶æ— ç©·å°ã€‚</p>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.75); padding: 15px; border-radius: 8px;">
                        <p><strong>ä¾‹2ï¼š</strong>å½“ $x \to 0$ï¼Œ$\displaystyle\frac{x^3}{x} \to 0$ï¼Œå› æ­¤ $x^3$ ä¹Ÿæ˜¯ $x$ çš„é«˜é˜¶æ— ç©·å°ã€‚</p>
                    </div>
                </div>
                <div class="visual-hint">ğŸ“‰ é«˜é˜¶æ— ç©·å°â€œä¿¯å†²â€å¾—æœ€è¿…é€Ÿï¼Œæ˜¯æˆ‘ä»¬åˆ¤æ–­æ”¶æ•›é€Ÿåº¦çš„æ ‡æ†ã€‚</div>`,
                animation: "infinitesimal_compare"
            },
            {
                title: "ä½é˜¶æ— ç©·å°",
                content: `<h3>ä½é˜¶æ— ç©·å°ï¼šæ‰å¾—æ›´æ…¢</h3>
                <div class="definition" style="background: rgba(231, 76, 60, 0.1); padding: 20px; border-radius: 10px; border-left: 4px solid #e74c3c;">
                    <p><strong>å®šä¹‰ï¼š</strong>è‹¥ $\displaystyle\lim\frac{\beta}{\alpha}=\infty$ï¼Œåˆ™ $\beta$ æ˜¯æ¯” $\alpha$ æ›´ä½é˜¶çš„æ— ç©·å°ã€‚</p>
                </div>
                <div style="margin: 20px 0;">
                    <h4>ğŸ“ å…¸å‹ä¾‹å­</h4>
                    <div style="background: rgba(255, 255, 255, 0.75); padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                        <p><strong>ä¾‹1ï¼š</strong>å½“ $x \to 0$ï¼Œ$\displaystyle\frac{x}{x^2} \to \infty$ï¼Œå› æ­¤ $x$ æ˜¯æ¯” $x^2$ æ›´ä½é˜¶çš„æ— ç©·å°ã€‚</p>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.75); padding: 15px; border-radius: 8px;">
                        <p><strong>ä¾‹2ï¼š</strong>å½“ $x \to 0^+$ï¼Œ$\displaystyle\frac{\sqrt{x}}{x} \to \infty$ï¼Œå› æ­¤ $\sqrt{x}$ ä½äº $x$ã€‚</p>
                    </div>
                </div>
                <div class="visual-hint">ğŸ“ˆ ä½é˜¶æ— ç©·å°åƒâ€œæ…¢è·‘è€…â€ï¼Œéœ€è¦æ›´é•¿æ—¶é—´æ‰èƒ½æ¥è¿‘ 0ã€‚</div>`,
                animation: "infinitesimal_compare"
            },
            {
                title: "åŒé˜¶æ— ç©·å°",
                content: `<h3>åŒé˜¶æ— ç©·å°ï¼šå¹¶é©¾é½é©±</h3>
                <div class="definition" style="background: rgba(155, 89, 182, 0.1); padding: 20px; border-radius: 10px; border-left: 4px solid #9b59b6;">
                    <p><strong>å®šä¹‰ï¼š</strong>è‹¥ $\displaystyle\lim\frac{\beta}{\alpha}=c\neq0$ï¼Œåˆ™ $\beta$ ä¸ $\alpha$ æ˜¯åŒé˜¶æ— ç©·å°ã€‚</p>
                    <p><strong>ç†è§£ï¼š</strong>ä¸¤ä¸ªé‡æœ 0 çš„â€œé€Ÿåº¦â€ä¸€è‡´ã€‚</p>
                </div>
                <div style="margin: 20px 0;">
                    <h4>ğŸ“ å…¸å‹ä¾‹å­</h4>
                    <div style="background: rgba(255, 255, 255, 0.75); padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                        <p><strong>ä¾‹1ï¼š</strong>$\displaystyle\frac{2x}{x} \to 2$ï¼Œå› æ­¤ $2x$ ä¸ $x$ åŒé˜¶ã€‚</p>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.75); padding: 15px; border-radius: 8px;">
                        <p><strong>ä¾‹2ï¼š</strong>$\displaystyle\frac{3x^2}{x^2} \to 3$ï¼Œå› æ­¤ $3x^2$ ä¸ $x^2$ åŒé˜¶ã€‚</p>
                    </div>
                </div>
                <div class="visual-hint">ğŸƒâ€â™‚ï¸ğŸƒâ€â™€ï¸ ä¸¤ä¸ªé€‰æ‰‹å¹¶è‚©å†²çº¿ï¼Œæ„å‘³ç€å®ƒä»¬å¯ä»¥äº’ç›¸æ¯”è¾ƒä¹Ÿèƒ½äº’æ¢å°ºåº¦ã€‚</div>`,
                animation: "infinitesimal_compare"
            },
            {
                title: "ç­‰ä»·æ— ç©·å°ï¼šå¯äº’æ¢çš„æ›¿èº«",
                content: `<h3>ç­‰ä»·æ— ç©·å°ï¼šè®¡ç®—é‡Œçš„é»„é‡‘æ­æ¡£</h3>
                <div class="definition" style="background: rgba(46, 204, 113, 0.12); padding: 20px; border-radius: 10px; border-left: 4px solid #2ecc71;">
                    <p><strong>å®šä¹‰ï¼š</strong>è‹¥ $\displaystyle\lim\frac{\beta}{\alpha}=1$ï¼Œè®°ä½œ $\alpha\sim\beta$ï¼Œå®ƒä»¬åœ¨æé™è¿ç®—ä¸­å¯ä»¥äº’æ¢ã€‚</p>
                    <p><strong>æ„ä¹‰ï¼š</strong>æŠŠå¤æ‚è¡¨è¾¾å¼æ¢æˆç†Ÿæ‚‰çš„â€œæ›¿èº«â€ï¼Œèƒ½æ˜¾è‘—ç®€åŒ–æé™è¿ç®—ã€‚</p>
                </div>
                <div class="prompt-card">åœ¨ä¸‹ä¸€å¼ å¹»ç¯ç‰‡ï¼Œæˆ‘ä»¬æ•´ç†äº†æœ€å¸¸ç”¨çš„ç­‰ä»·æ— ç©·å°è¡¨ï¼Œè®²é¢˜æ—¶ç›´æ¥å¼•ç”¨å³å¯ã€‚</div>
                <div class="visual-hint">ğŸ”„ ç­‰ä»·æ— ç©·å°æ˜¯ä¸€å¯¹â€œå½±åˆ†èº«â€ï¼Œéšæ—¶å¯ä»¥æ— ç¼æ›¿æ¢ã€‚</div>`,
                animation: "infinitesimal_compare"
            },            {
                title: "å¸¸ç”¨ç­‰ä»·æ— ç©·å°",
                content: `<h3>å¸¸ç”¨çš„ç­‰ä»·æ— ç©·å°ï¼ˆå½“ $x\to 0$ æ—¶ï¼‰</h3>
                <div style="display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 16px; margin: 20px 0;">
                    <div style="background: rgba(59,130,246,0.1); padding: 14px; border-radius: 10px; border-left: 4px solid #3b82f6;">
                        <p>$\sin x \sim x$</p>
                        <p>$\tan x \sim x$</p>
                        <p>$\arcsin x \sim x$</p>
                        <p>$\arctan x \sim x$</p>
                    </div>
                    <div style="background: rgba(16,185,129,0.1); padding: 14px; border-radius: 10px; border-left: 4px solid #10b981;">
                        <p>$1-\cos x \sim \tfrac{1}{2}x^{2}$</p>
                        <p>$\ln(1+x) \sim x$</p>
                        <p>$e^{x}-1 \sim x$</p>
                        <p>$\sqrt{1+x}-1 \sim \tfrac{1}{2}x$</p>
                    </div>
                </div>
                <div class="note">ç­‰ä»·æ— ç©·å°å¯ä»¥åœ¨æé™è¿ç®—ä¸­<strong>ç›´æ¥äº’æ¢</strong>ï¼Œè®°å¾—é™„å¸¦â€œ$x\to 0$â€è¿™ä¸€å‰ææ¡ä»¶ã€‚</div>`,
                animation: "equivalent_infinitesimal"
            },            {
                title: "å›å½’åˆå¿ƒï¼šè°èƒ½ç›´æ¥ä»£å…¥ï¼Ÿ",
                content: `
                <h2>ğŸ”„ å›å½’åˆå¿ƒï¼šä»€ä¹ˆæ ·çš„å‡½æ•°â€œå¥½åˆ°å¯ä»¥ç›´æ¥ä»£å…¥â€?</h2>
                <p>æˆ‘ä»¬æœ€æ—©æ¥è§¦çš„æ±‚æé™æ–¹æ³•â€”â€”ç›´æ¥ä»£å…¥æ³•ï¼Œéœ€è¦å‡½æ•°åœ¨ç›®æ ‡ç‚¹é™„è¿‘è¡¨ç°â€œå¹³æ»‘â€ã€‚</p>
                <div class="teacher-note">â€œè¿ç»­æ€§â€æ­£æ˜¯ç”¨æé™è¯­è¨€åˆ»ç”»è¿™ç§å¥½æ€§è´¨çš„å·¥å…·ã€‚</div>
                `,
                animation: "continuity_intro"
            },
            {
                title: "è¿ç»­æ€§æ¦‚å¿µ",
                content: `<h2>2.4 å‡½æ•°çš„è¿ç»­æ€§</h2><h3>2.4.1 è¿ç»­å‡½æ•°çš„æ¦‚å¿µ</h3><h4>1. å‡½æ•°çš„å¢é‡</h4><p>è‡ªå˜é‡çš„å¢é‡: $\Delta x = x - x_0$</p><p>å‡½æ•°çš„å¢é‡: $\Delta y=f(x_{0}+\Delta x)-f(x_{0})$</p><div class="note">ä¸€ä¸ªå¾®å°çš„xå˜åŒ–($\Delta x \to 0$), åªä¼šå¼•èµ·ä¸€ä¸ªå¾®å°çš„yå˜åŒ–($\Delta y \to 0$), è¿™å°±æ˜¯è¿ç»­ã€‚</div>`,
                animation: "continuity_concept"
            },
            {
                title: "è¿ç»­æ€§çš„ä¸‰ä½ä¸€ä½“",
                content: `
                <h2>ğŸ—ï¸ è¿ç»­æ€§çš„ä¸‰ä½ä¸€ä½“</h2>
                <p>å‡½æ•° $f(x)$ åœ¨ $x_0$ å¤„è¿ç»­ï¼Œå½“ä¸”ä»…å½“ä»¥ä¸‹ä¸‰ä»¶äº‹åŒæ—¶æˆç«‹ï¼š</p>
                <ol>
                    <li>$f(x_0)$ æœ‰å®šä¹‰ï¼ˆç›®æ ‡å­˜åœ¨ï¼‰</li>
                    <li>$\displaystyle\lim_{x\to x_0} f(x)$ å­˜åœ¨ï¼ˆå·¦å³éš§é“ä¼šå¸ˆï¼‰</li>
                    <li>æé™å€¼ç­‰äºå‡½æ•°å€¼ï¼ˆä¼šå¸ˆç‚¹æ­£å¥½è½åœ¨ç›®æ ‡ç‚¹ï¼‰</li>
                </ol>
                <div class="teacher-note">â€œè¿™ä¸‰ä¸ªæ¡ä»¶ç¼ºä¸€ä¸å¯â€”â€”å°‘äº†ä»»ä½•ä¸€é¡¹ï¼Œéš§é“éƒ½ä¼šæ–­ã€‚â€</div>
                `,
                animation: "continuity_three"
            },
            {
                title: "å¦‚ä½•è¯Šæ–­ä¸è¿ç»­ï¼šå¯¹ç—‡ä¸‹è¯",
                content: `
                <h2>ğŸ©º è¯Šæ–­é—´æ–­ç‚¹ï¼šå“ªä¸€æ­¥å‡ºäº†é—®é¢˜ï¼Ÿ</h2>
                <ul>
                    <li><strong>å¯å»é—´æ–­ï¼š</strong>æé™å­˜åœ¨ï¼Œä½† $f(x_0)$ æ²¡å®šä¹‰æˆ–ä¸ç­‰äºæé™ â€”â€” â€œæŠŠç¼ºå£è¡¥ä¸Šå³å¯ã€‚â€</li>
                    <li><strong>è·³è·ƒé—´æ–­ï¼š</strong>å·¦å³æé™å­˜åœ¨ä½†ä¸ç›¸ç­‰ â€”â€” â€œä¸¤æ”¯é˜Ÿä¼é«˜åº¦å¯¹ä¸ä¸Šã€‚â€</li>
                    <li><strong>æ— ç©·é—´æ–­ï¼š</strong>è‡³å°‘ä¸€ä¾§æé™ä¸ºæ— ç©· â€”â€” â€œéš§é“æŒ–è¿›äº†æ— åº•æ´ã€‚â€</li>
                </ul>
                `,
                animation: "discontinuity_diagnose"
            },
            {
                title: "å¥½æ¶ˆæ¯ï¼šåˆç­‰å‡½æ•°éƒ½ä¹–",
                content: `
                <h2>ğŸ‰ å¥½æ¶ˆæ¯ï¼šåˆç­‰å‡½æ•°åœ¨å®šä¹‰åŸŸå†…éƒ½è¿ç»­</h2>
                <p>å¤šé¡¹å¼ã€æŒ‡æ•°ã€å¯¹æ•°ã€ä¸‰è§’ã€åä¸‰è§’â€¦â€¦è¿™äº›ç†Ÿæ‚‰çš„å‡½æ•°ï¼Œåªè¦æ‰€æ±‚çš„ç‚¹åœ¨å®šä¹‰åŸŸå†…ï¼Œå°±å¯ä»¥æ”¾å¿ƒç”¨â€œç›´æ¥ä»£å…¥â€ã€‚</p>
                <div class="note">æˆ‘ä»¬æ„å»ºçš„æé™ç†è®ºï¼Œä¸ºè¿™ä¸ªâ€œçœ‹ä¼¼ç®€å•â€çš„æ“ä½œæä¾›äº†ä¸¥æ ¼ä¿éšœã€‚</div>
                `,
                animation: "elementary_continuity"
            },
            {
                title: "å®ä¾‹3 å†°èåŒ–",
                content: `<div class="example"><strong>å®ä¾‹3 å†°èåŒ–æ‰€éœ€çƒ­é‡</strong><br>$f(x) = \begin{cases} 2.1x + 84, & x \geq 0 \\ 4.2x + 420, & x > 0 \end{cases}$<br>å½“ $x=0$ æ—¶,å‡½æ•°æ˜¯å¦è¿ç»­?</div><p><strong>è§£</strong>: $\displaystyle\lim_{x \to 0^-} f(x) = 84$, $\displaystyle\lim_{x \to 0^+} f(x) = 420$</p><p>å·¦å³æé™ä¸ç›¸ç­‰, æ‰€ä»¥å‡½æ•°åœ¨ $x=0$ å¤„ä¸è¿ç»­ã€‚</p>`,
                animation: "ice_melting"
            },
            {
                title: "é—´æ–­ç‚¹",
                content: `<h3>2.4.2 å‡½æ•°çš„é—´æ–­ç‚¹</h3><p>å‡½æ•°ä¸è¿ç»­çš„ç‚¹ç§°ä¸º<strong>é—´æ–­ç‚¹</strong>ã€‚æœ‰ä¸‰ç§æƒ…å½¢ï¼š(1)åœ¨ $x_0$ æ— å®šä¹‰ï¼›(2)åœ¨ $x_0$ æ— æé™ï¼›(3)æé™ä¸ç­‰äºå‡½æ•°å€¼ã€‚</p>`,
                animation: "discontinuity"
            },
            {
                title: "ç¬¬ä¸€ç±»é—´æ–­ç‚¹",
                content: `<h4>ç¬¬ä¸€ç±»é—´æ–­ç‚¹ (å·¦å³æé™éƒ½å­˜åœ¨)</h4><div class="definition"><strong>å¯å»é—´æ–­ç‚¹</strong>ï¼šå°±åƒè·¯ä¸Šçš„ä¸€ä¸ª<strong>å°å‘</strong>ã€‚å·¦å³æé™ç›¸ç­‰, ä½†è¯¥ç‚¹æ— å®šä¹‰æˆ–å‡½æ•°å€¼ä¸ç­‰äºæé™å€¼ã€‚</div><div class="theorem"><strong>è·³è·ƒé—´æ–­ç‚¹</strong>ï¼šå°±åƒè·¯ä¸Šçš„ä¸€ä¸ª<strong>å°é˜¶</strong>ã€‚å·¦å³æé™å­˜åœ¨ä½†ä¸ç›¸ç­‰ã€‚</div>`,
                animation: "first_discontinuity"
            },
            {
                title: "ç¬¬äºŒç±»é—´æ–­ç‚¹",
                content: `<h4>ç¬¬äºŒç±»é—´æ–­ç‚¹ (è‡³å°‘ä¸€ä¸ªæé™ä¸å­˜åœ¨)</h4><div class="definition"><strong>æ— ç©·é—´æ–­ç‚¹</strong>ï¼šå°±åƒä¸€ä¸ª<strong>æ— åº•æ·±æ¸Š</strong>ã€‚æé™ä¸ºæ— ç©·å¤§, å¦‚ $y = \\tan x$ åœ¨ $x = \\frac{\\pi}{2}$ å¤„ã€‚</div><div class="theorem"><strong>éœ‡è¡é—´æ–­ç‚¹</strong>ï¼šå°±åƒä¸€ä¸ª<strong>åœ°éœ‡å¸¦</strong>ã€‚å‡½æ•°åœ¨æŸç‚¹é™„è¿‘æ— é™æ¬¡éœ‡è¡, å¦‚ $y = \\sin \\frac{1}{x}$ åœ¨ $x=0$ å¤„ã€‚</div>`,
                animation: "second_discontinuity"
            },
            {
                title: "åˆç­‰å‡½æ•°çš„è¿ç»­æ€§",
                content: `<h3>2.4.3 åˆç­‰å‡½æ•°çš„è¿ç»­æ€§</h3><div class="theorem"><strong>å®šç†3</strong> ä¸€åˆ‡åˆç­‰å‡½æ•°åœ¨å…¶å®šä¹‰åŒºé—´å†…éƒ½æ˜¯è¿ç»­çš„ã€‚</div><div class="note">è¿™æ„å‘³ç€å¯¹äºå¤šé¡¹å¼ã€æŒ‡æ•°ã€å¯¹æ•°ã€ä¸‰è§’å‡½æ•°ç­‰ï¼Œæˆ‘ä»¬åªéœ€åœ¨å®šä¹‰åŸŸçš„åˆ†ç•Œç‚¹ã€æˆ–å¯èƒ½å¯¼è‡´åˆ†æ¯ä¸º0çš„ç‚¹æ£€æŸ¥è¿ç»­æ€§ã€‚</div>`,
                animation: "elementary_continuity"
            },
            {
                title: "ç»ƒä¹ é¢˜1",
                content: `<div class="example"><strong>ç»ƒä¹ 1</strong> è‹¥ $\displaystyle\lim_{x \to -1} \frac{x^3+ax^2-x+4}{x+1} = b$, æ±‚a, b.</div><p><strong>è§£</strong>: åˆ†æ¯ $\to 0$ ä¸”æé™å­˜åœ¨ $\implies$ åˆ†å­ $\to 0$ã€‚<br>$(-1)^3 + a(-1)^2 - (-1) + 4 = 0 \implies a = -4$</p><p>ä»£å…¥åçº¦å»é›¶å› å­ $(x+1)$, å¾— $b = \displaystyle\lim_{x \to -1} (x^2-5x+4) = 10$</p>`,
                animation: "exercise1"
            },
            {
                title: "ç»ƒä¹ é¢˜2",
                content: `<div class="example"><strong>ç»ƒä¹ 2</strong> æ±‚ $\displaystyle\lim_{x \to 0} \frac{\sqrt{1+x}-\sqrt{1-x}}{\sin 3x}$</div><p><strong>è§£</strong>: åˆ†å­æœ‰ç†åŒ–å¹¶ç”¨ç­‰ä»·æ— ç©·å°æ›¿æ¢ $\sin 3x \sim 3x$</p><p>$\displaystyle\lim_{x \to 0} \frac{(1+x)-(1-x)}{3x(\sqrt{1+x}+\sqrt{1-x})} = \lim_{x \to 0} \frac{2x}{3x(\sqrt{1+x}+\sqrt{1-x})} = \frac{2}{3(2)} = \frac{1}{3}$</p>`,
                animation: "exercise2"
            },
            {
                title: "æ€»ç»“",
                content: `<h2>æœ¬ç« æ€»ç»“</h2><h3>æ ¸å¿ƒæ¦‚å¿µ</h3><ul><li><strong>æé™</strong>ï¼šå‡½æ•°å˜åŒ–çš„"ç›®æ ‡å€¼"</li><li><strong>è¿ç»­</strong>ï¼šæ²¡æœ‰"è·³è·ƒ"çš„å‡½æ•°</li><li><strong>æ— ç©·å°</strong>ï¼šè¶‹å‘äº0çš„å˜é‡</li><li><strong>ä¸¤ä¸ªé‡è¦æé™</strong>ï¼šå¾®ç§¯åˆ†çš„åŸºçŸ³</li></ul>`,
                animation: "summary"
            }
        ];

        let currentSlide = 1;
        const totalSlides = slidesData.length;
        let autoPlayInterval = null;
        let animationFrameId = null;

        // æ¸²æŸ“å™¨çŠ¶æ€
        let renderingInProgress = false;

        // MathJax è¾…åŠ©å‡½æ•°ï¼Œç¡®ä¿åœ¨ä»»ä½•åœ°æ–¹è°ƒç”¨æ—¶éƒ½èƒ½æŒ‰é¡ºåºå®‰å…¨æ¸²æŸ“
        function waitForMathJaxReady(timeout = 10000) {
            return new Promise((resolve, reject) => {
                const start = Date.now();

                const check = () => {
                    const mj = window.MathJax;
                    if (mj && mj.typesetPromise) {
                        const startupPromise = mj.startup && mj.startup.promise;
                        if (startupPromise && typeof startupPromise.then === 'function') {
                            const elapsed = Date.now() - start;
                            if (elapsed >= timeout) {
                                reject(new Error('MathJax startup timeout'));
                                return;
                            }
                            const remaining = timeout - elapsed;
                            const timeoutId = setTimeout(() => {
                                reject(new Error('MathJax startup timeout'));
                            }, remaining);
                            startupPromise.then(() => {
                                clearTimeout(timeoutId);
                                resolve(mj);
                            }).catch((err) => {
                                clearTimeout(timeoutId);
                                reject(err);
                            });
                        } else {
                            resolve(mj);
                        }
                        return;
                    }

                    if (Date.now() - start >= timeout) {
                        reject(new Error('MathJax not available after timeout'));
                        return;
                    }

                    setTimeout(check, 100);
                };

                check();
            });
        }

        const queueMathTypeset = (() => {
            let chain = Promise.resolve();
            return function(rootElements) {
                if (!window.MathJax || !window.MathJax.typesetPromise) {
                    return Promise.resolve();
                }

                let elements;
                if (Array.isArray(rootElements)) {
                    elements = rootElements;
                } else if (rootElements && typeof rootElements.length === 'number' && typeof rootElements !== 'string') {
                    elements = Array.from(rootElements);
                } else if (rootElements) {
                    elements = [rootElements];
                }

                chain = chain.then(() => {
                    if (!window.MathJax || !window.MathJax.typesetPromise) {
                        return true;
                    }
                    const promise = (elements && elements.length > 0)
                        ? window.MathJax.typesetPromise(elements)
                        : window.MathJax.typesetPromise();
                    return promise.then(() => true);
                }).catch((err) => {
                    console.error('MathJax typeset error:', err);
                    return false;
                });

                return chain;
            };
        })();

        function resetMathJaxState() {
            if (!window.MathJax) {
                return;
            }
            if (typeof window.MathJax.texReset === 'function') {
                window.MathJax.texReset();
            }
            if (typeof window.MathJax.typesetClear === 'function') {
                window.MathJax.typesetClear();
            } else if (window.MathJax.startup && window.MathJax.startup.document && typeof window.MathJax.startup.document.state === 'function') {
                window.MathJax.startup.document.state(0);
            }
        }

        // åˆå§‹åŒ–å¹¶åˆ›å»ºæ‰€æœ‰å¹»ç¯ç‰‡
        async function initSlides() {
            try {
                const container = document.getElementById('slidesContainer');
                if (!container) {
                    console.error('Slides container not found');
                    return;
                }

                // æ¸…ç©ºå®¹å™¨
                container.innerHTML = '';

                // åˆ›å»ºæ‰€æœ‰å¹»ç¯ç‰‡
                slidesData.forEach((slide, index) => {
                    const slideDiv = document.createElement('div');
                    slideDiv.className = `slide ${index === 0 ? 'active' : ''}`;
                    slideDiv.id = `slide${index + 1}`;
                    slideDiv.innerHTML = `<div class="slide-container"><div class="left-content tex2jax_process">${slide.content}</div><div class="right-visual"><canvas id="canvas${index + 1}" width="600" height="400"></canvas></div></div>`;
                    container.appendChild(slideDiv);
                });

                // ç­‰å¾…MathJaxåŠ è½½å®Œæˆåæ¸²æŸ“
                waitForMathJaxReady()
                    .then(() => {
                        console.log('å¼€å§‹æ¸²æŸ“æ•°å­¦å…¬å¼...');
                        // æ¸²æŸ“æ‰€æœ‰å¹»ç¯ç‰‡
                        return queueMathTypeset();
                    })
                    .then((success) => {
                        if (!success) {
                            console.warn('åˆå§‹å…¬å¼æ¸²æŸ“è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜');
                        } else {
                            console.log('å…¬å¼æ¸²æŸ“å®Œæˆ');
                        }
                        drawAnimation(1);
                        hideLoading();
                    })
                    .catch((err) => {
                        console.error('MathJax typeset error:', err);
                        drawAnimation(1);
                        hideLoading();
                    });
            } catch (error) {
                console.error('Error initializing slides:', error);
            }
        }

        // æ˜¾ç¤ºæŒ‡å®šå¹»ç¯ç‰‡
        function showSlide(n) {
            if (animationFrameId) {
                cancelAnimationFrame(animationFrameId);
                animationFrameId = null;
            }
            const slides = document.getElementsByClassName('slide');
            currentSlide = (n > totalSlides) ? 1 : (n < 1) ? totalSlides : n;
            
            // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
            Array.from(slides).forEach(s => s.classList.remove('active'));
            
            // è·å–ç›®æ ‡å¹»ç¯ç‰‡
            const targetSlide = slides[currentSlide - 1];
            targetSlide.classList.add('active');
            
            // é‡æ–°æ¸²æŸ“å½“å‰å¹»ç¯ç‰‡çš„å…¬å¼
            if (window.MathJax && window.MathJax.typesetPromise) {
                window.MathJax.typesetPromise([targetSlide]).catch((err) => console.log('MathJax typeset error:', err));
            }
            
            // æ›´æ–°é¡µç æ˜¾ç¤º
            document.getElementById('slideNumber').textContent = `${currentSlide} / ${totalSlides}`;
            
            // ç›´æ¥ç»˜åˆ¶åŠ¨ç”»ï¼ŒMathJaxä¼šè‡ªåŠ¨å¤„ç†å…¬å¼
            setTimeout(() => drawAnimation(currentSlide), 100);
        }

        // å¯¼èˆªåŠŸèƒ½
        function nextSlide() { showSlide(currentSlide + 1); }
        function prevSlide() { showSlide(currentSlide - 1); }
        function autoPlay() {
            const btn = document.getElementById('autoPlayBtn');
            if (autoPlayInterval) {
                clearInterval(autoPlayInterval);
                autoPlayInterval = null;
                btn.textContent = 'è‡ªåŠ¨æ’­æ”¾';
            } else {
                autoPlayInterval = setInterval(nextSlide, 5000);
                btn.textContent = 'åœæ­¢æ’­æ”¾';
            }
        }

        // åŠ¨ç”»ä¸»è·¯ç”±
        function drawAnimation(slideNum) {
            try {
                const canvas = document.getElementById(`canvas${slideNum}`);
                if (!canvas) {
                    console.warn(`Canvas not found for slide ${slideNum}`);
                    return;
                }
                const ctx = canvas.getContext('2d');
                if (!ctx) {
                    console.warn(`Could not get 2D context for canvas ${slideNum}`);
                    return;
                }

                const slide = slidesData[slideNum - 1];
                if (!slide) {
                    console.warn(`Slide data not found for slide ${slideNum}`);
                    return;
                }

                const animationType = slide.animation;
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                const animationMap = {
                    title: drawTitleAnimation, view_shift: drawViewShift, sequence: drawSequenceAnimation, sequence_function: drawSequenceFunction, queue: drawQueueVisualization,
                    limit: drawLimitConcept, target: drawTargetAnimation, convergence: drawConvergenceDivergence,
                    collatz: drawCollatzSequence, fibonacci: drawFibonacciRatio, example1_1: drawSequenceAnimation,
                    example1_2: drawExample1_2, example1_3: drawExample1_3, example1_4: drawExample1_4,
                    depreciation: drawDepreciation, function_notation: drawFunctionNotation,
                    "function_limit_concept": drawFunctionLimitConcept, domain_approach: drawDomainApproach, population: drawPopulationGrowth,
                    function_infinity: drawFunctionInfinity, one_over_x: drawOneOverX, arctan: drawArctan,
                    shadow: drawShadowAnimation, point_limit: drawPointLimit, velocity: drawVelocity,
                    left_right: drawLeftRightLimits, left_limit_viz: drawLeftLimitViz, right_limit_viz: drawRightLimitViz, limit_convergence_viz: drawLimitConvergenceViz, piecewise1: drawPiecewise1, piecewise2: drawPiecewise2,
                    infinitesimal: drawInfinitesimalConcept, infinitesimal_prop: drawInfinitesimalProperties,
                    infinite: drawInfiniteConcept, limit_properties: drawLimitProperties, limit_rules: drawLimitRules,
                    direct_sub: drawDirectSubstitution, zero_zero: drawZeroOverZero, rationalize: drawRationalization,
                    infinity_infinity: drawInfinityOverInfinity, sinx_x: drawSinXOverX, e_limit: drawELimit,
                    infinitesimal_compare: drawInfinitesimalComparison, "equivalent_infinitesimal": drawEquivalentInfinitesimal,
                    continuity_concept: drawContinuityConcept, continuity_def: drawContinuityDefinition,
                    ice_melting: drawIceMelting, discontinuity: drawDiscontinuityTypes,
                    first_discontinuity: drawFirstDiscontinuity, second_discontinuity: drawSecondDiscontinuity,
                    elementary_continuity: drawElementaryContinuity, exercise1: drawExercise1, exercise2: drawExercise2,
                    summary: drawSummaryAnimation
                };

                const animationFunction = animationMap[animationType] || drawDefaultAnimation;
                animationFunction(ctx, canvas);
            } catch (error) {
                console.error(`Error in drawAnimation for slide ${slideNum}:`, error);
                // Fallback to default animation
                const canvas = document.getElementById(`canvas${slideNum}`);
                if (canvas) {
                    const ctx = canvas.getContext('2d');
                    if (ctx) drawDefaultAnimation(ctx, canvas);
                }
            }
        }

        // --- æ‰€æœ‰åŠ¨ç”»ç»˜åˆ¶å‡½æ•° ---
        
        function drawTitleAnimation(ctx, canvas) { 
            let angle = 0; 
            function animate() { 
                ctx.clearRect(0, 0, canvas.width, canvas.height); 
                ctx.save(); 
                ctx.translate(canvas.width / 2, canvas.height / 2); 
                for (let i = 0; i < 5; i++) { 
                    ctx.beginPath(); 
                    ctx.strokeStyle = `hsla(${i * 60 + angle * 100}, 80%, 60%, 0.7)`; 
                    ctx.lineWidth = 3; 
                    const radius = 50 + i * 20; 
                    ctx.arc(0, 0, radius, angle + i * 0.5, angle + i * 0.5 + Math.PI * 1.5); 
                    ctx.stroke(); 
                } 
                ctx.restore(); 
                ctx.font = 'bold 36px Arial'; 
                ctx.fillStyle = '#2c3e50'; 
                ctx.textAlign = 'center'; 
                ctx.fillText('æé™ä¸è¿ç»­', canvas.width / 2, canvas.height / 2 - 20); 
                ctx.font = '20px Arial'; 
                ctx.fillText('å¾®ç§¯åˆ†çš„åŸºç¡€', canvas.width / 2, canvas.height / 2 + 30); 
                angle += 0.01; 
                animationFrameId = requestAnimationFrame(animate); 
            } 
            animate(); 
        }

        function drawSequenceAnimation(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas, { mode: 'quadrant' }); 
            ctx.fillStyle = '#3498db'; 
            let n = 1; 
            function animate() { 
                if (n > 15) { 
                    // Draw limit line after points are drawn
                    const limitY = canvas.height - 50 - 1 * (canvas.height - 100); 
                    ctx.strokeStyle = '#e74c3c'; 
                    ctx.setLineDash([5, 5]); 
                    ctx.beginPath(); 
                    ctx.moveTo(50, limitY); 
                    ctx.lineTo(canvas.width - 50, limitY); 
                    ctx.stroke(); 
                    ctx.setLineDash([]); 
                    ctx.fillStyle = '#e74c3c'; 
                    ctx.font = '14px Arial'; 
                    ctx.fillText('æé™ a = 1', canvas.width - 90, limitY - 5); 
                    return; 
                } 
                const x_coord = 50 + n * 30; 
                const y_val = n / (n + 1); 
                const y_coord = canvas.height - 50 - y_val * (canvas.height - 100); 
                ctx.beginPath(); 
                ctx.arc(x_coord, y_coord, 4, 0, 2 * Math.PI); 
                ctx.fill(); 
                ctx.font = '10px Arial'; 
                ctx.textAlign = 'center'; 
                ctx.fillText(n, x_coord, canvas.height - 35); 
                n++; 
                animationFrameId = setTimeout(animate, 100); 
            } 
            animate(); 
        }

        function drawQueueVisualization(ctx, canvas) { 
            ctx.clearRect(0, 0, canvas.width, canvas.height); 
            for (let i = 0; i < 5; i++) { 
                const x = 80 + i * 100; 
                const y = 200; 
                ctx.fillStyle = '#3498db'; 
                ctx.beginPath(); 
                ctx.arc(x, y - 20, 20, 0, 2 * Math.PI); 
                ctx.fill(); 
                ctx.fillRect(x - 20, y, 40, 50); 
                ctx.fillStyle = '#fff'; 
                ctx.font = 'bold 18px Arial'; 
                ctx.textAlign = 'center'; 
                ctx.fillText(i + 1, x, y - 15); 
                ctx.fillStyle = '#2c3e50'; 
                ctx.font = '14px Arial'; 
                ctx.fillText(`x_${i + 1}`, x, y + 80); 
            } 
            drawArrow(ctx, 550, 220, 600, 220, '#e74c3c', 3); 
            ctx.font = '20px Arial'; 
            ctx.fillText('...', 575, 225); 
        }

        function drawLimitConcept(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas); 
            ctx.fillStyle = '#3498db'; 
            for (let n = 1; n <= 30; n++) { 
                const x = 50 + n * 15; 
                const y = canvas.height / 2 + (1 / n) * 100 * (n % 2 === 0 ? 1 : -1); 
                ctx.beginPath(); 
                ctx.arc(x, y, 2, 0, 2 * Math.PI); 
                ctx.fill(); 
            } 
            ctx.strokeStyle = '#e74c3c'; 
            ctx.setLineDash([5, 5]); 
            ctx.beginPath(); 
            ctx.moveTo(50, canvas.height / 2); 
            ctx.lineTo(canvas.width - 50, canvas.height / 2); 
            ctx.stroke(); 
            ctx.setLineDash([]); 
        }

        function drawTargetAnimation(ctx, canvas) { 
            let points = Array.from({length: 20}, () => ({
                angle: Math.random() * 2 * Math.PI, 
                radius: 20 + Math.random() * 150, 
                speed: 0.5 + Math.random()
            })); 
            function animate() { 
                ctx.clearRect(0, 0, canvas.width, canvas.height); 
                const centerX = canvas.width / 2; 
                const centerY = canvas.height / 2; 
                for (let r = 150; r > 0; r -= 30) { 
                    ctx.beginPath(); 
                    ctx.strokeStyle = (r / 30 % 2 === 1) ? '#e74c3c' : '#3498db'; 
                    ctx.lineWidth = 15; 
                    ctx.arc(centerX, centerY, r, 0, 2 * Math.PI); 
                    ctx.stroke(); 
                } 
                ctx.fillStyle = '#2c3e50'; 
                points.forEach(p => { 
                    p.radius -= p.speed; 
                    if (p.radius < 5) p.radius = 170; 
                    const x = centerX + Math.cos(p.angle) * p.radius; 
                    const y = centerY + Math.sin(p.angle) * p.radius; 
                    ctx.beginPath(); 
                    ctx.arc(x, y, 3, 0, 2 * Math.PI); 
                    ctx.fill(); 
                }); 
                animationFrameId = requestAnimationFrame(animate); 
            } 
            animate(); 
        }

        function drawConvergenceDivergence(ctx, canvas) { 
            ctx.save(); 
            drawCoordinateSystem(ctx, { width: canvas.width / 2, height: canvas.height }); 
            ctx.fillStyle = '#2ecc71'; 
            for (let n = 1; n < 20; n++) { 
                const x = 20 + n * 12; 
                const y = canvas.height / 2 + (1 / n) * 80 * (n % 2 === 0 ? 1 : -1); 
                ctx.beginPath(); 
                ctx.arc(x, y, 2, 0, 2 * Math.PI); 
                ctx.fill(); 
            } 
            ctx.font = 'bold 16px Arial'; 
            ctx.textAlign = 'center'; 
            ctx.fillText('æ”¶æ•›', canvas.width / 4, 40); 
            ctx.restore(); 
            ctx.save(); 
            ctx.translate(canvas.width / 2, 0); 
            drawCoordinateSystem(ctx, { width: canvas.width / 2, height: canvas.height }); 
            ctx.fillStyle = '#e74c3c'; 
            for (let n = 1; n < 15; n++) { 
                const x = 20 + n * 15; 
                const y = canvas.height / 2 + Math.sin(n) * 80; 
                ctx.beginPath(); 
                ctx.arc(x, y, 2, 0, 2 * Math.PI); 
                ctx.fill(); 
            } 
            ctx.font = 'bold 16px Arial'; 
            ctx.textAlign = 'center'; 
            ctx.fillText('å‘æ•£', canvas.width / 4, 40); 
            ctx.restore(); 
        }

        function drawCollatzSequence(ctx, canvas) { 
            let n = 27; 
            const sequence = [n]; 
            while (n !== 1 && sequence.length < 50) { 
                n = (n % 2 === 0) ? n / 2 : 3 * n + 1; 
                sequence.push(n); 
            } 
            drawCoordinateSystem(ctx, canvas, { mode: 'quadrant' }); 
            ctx.strokeStyle = '#9b59b6'; 
            ctx.lineWidth = 1.5; 
            ctx.beginPath(); 
            sequence.forEach((val, i) => { 
                const x = 50 + i * 10; 
                const y = canvas.height - 50 - Math.min(val * 2, canvas.height - 100); 
                if (i === 0) ctx.moveTo(x, y); 
                else ctx.lineTo(x, y); 
            }); 
            ctx.stroke(); 
        }

        function drawFibonacciRatio(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas, { mode: 'quadrant' }); 
            let a = 1, b = 1; 
            ctx.strokeStyle = '#f39c12'; 
            ctx.lineWidth = 2; 
            ctx.beginPath(); 
            for (let i = 0; i < 15; i++) { 
                const ratio = b / a; 
                const x = 50 + i * 35; 
                const y = canvas.height - 50 - ratio * 100; 
                if (i === 0) ctx.moveTo(x, y); 
                else ctx.lineTo(x, y); 
                const temp = b; 
                b = a + b; 
                a = temp; 
            } 
            ctx.stroke(); 
            const phi = 1.618; 
            ctx.strokeStyle = '#e74c3c'; 
            ctx.setLineDash([5, 5]); 
            const phiY = canvas.height - 50 - phi * 100; 
            ctx.moveTo(50, phiY); 
            ctx.lineTo(canvas.width - 50, phiY); 
            ctx.stroke(); 
            ctx.setLineDash([]); 
        }

        function drawExample1_2(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas, { mode: 'quadrant' }); 
            ctx.fillStyle = '#e74c3c'; 
            for (let n = 1; n <= 20; n++) { 
                const x = 50 + n * 25; 
                const val = (1 + Math.pow(-1, n)) / 2; 
                const y = canvas.height - 50 - val * 200; 
                ctx.beginPath(); 
                ctx.arc(x, y, 4, 0, 2 * Math.PI); 
                ctx.fill(); 
            } 
        }

        function drawExample1_3(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas); 
            ctx.fillStyle = '#2ecc71'; 
            for (let n = 1; n <= 10; n++) { 
                const x = 50 + n * 50; 
                const val = 1 / Math.pow(-3, n); 
                const y = canvas.height / 2 - val * 500; 
                ctx.beginPath(); 
                ctx.arc(x, y, 3, 0, 2 * Math.PI); 
                ctx.fill(); 
            } 
        }

        function drawExample1_4(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas); 
            const y_coord = canvas.height / 2 - 80; 
            ctx.strokeStyle = '#9b59b6'; 
            ctx.lineWidth = 3; 
            ctx.beginPath(); 
            ctx.moveTo(50, y_coord); 
            ctx.lineTo(canvas.width - 50, y_coord); 
            ctx.stroke(); 
        }

        function drawDepreciation(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas, { mode: 'quadrant' }); 
            ctx.strokeStyle = '#e74c3c'; 
            ctx.lineWidth = 2; 
            ctx.beginPath(); 
            for (let n = 0; n <= 40; n++) { 
                const val = 100 * Math.pow(0.9, n); 
                const x = 50 + n * 12; 
                const y = canvas.height - 50 - val * 3; 
                if (n === 0) ctx.moveTo(x, y); 
                else ctx.lineTo(x, y); 
            } 
            ctx.stroke(); 
        }

        function drawFunctionNotation(ctx, canvas) { 
            ctx.font = '20px Arial'; 
            ctx.textAlign = 'center'; 
            ctx.fillText('å‡½æ•°çš„å„ç§è¶‹è¿‘æ–¹å¼', canvas.width / 2, 50); 
            drawCoordinateSystem(ctx, canvas); 
            ctx.fillStyle = '#3498db'; 
            // x -> +inf
            drawArrow(ctx, 400, canvas.height/2, 550, canvas.height/2); 
            // x -> x0-
            drawArrow(ctx, 150, canvas.height/2 + 50, 290, canvas.height/2 + 5); 
            // x -> x0+
            drawArrow(ctx, 450, canvas.height/2 - 50, 310, canvas.height/2 - 5); 
        }

        function drawFunctionLimitConcept(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas); 
            ctx.strokeStyle = '#3498db'; 
            ctx.lineWidth = 2; 
            ctx.beginPath(); 
            for(let x_val = -3; x_val <= 3; x_val += 0.1) { 
                const x = canvas.width/2 + x_val * 80; 
                const y = canvas.height/2 - (1/(x_val*x_val + 1)) * 150; 
                if(x_val===-3) ctx.moveTo(x, y); 
                else ctx.lineTo(x,y); 
            } 
            ctx.stroke(); 
        }

        function drawPopulationGrowth(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas, { mode: 'quadrant' }); 
            ctx.strokeStyle = '#2ecc71'; 
            ctx.lineWidth = 2; 
            ctx.beginPath(); 
            for (let t = 0; t <= 50; t++) { 
                const K = 250; 
                const x = 50 + t * 10; 
                const y = canvas.height - 50 - (K / (1 + 24 * Math.exp(-0.1 * t))); 
                if (t === 0) ctx.moveTo(x, y); 
                else ctx.lineTo(x, y); 
            } 
            ctx.stroke(); 
            const limitY = canvas.height - 50 - 250; 
            ctx.strokeStyle = '#e74c3c'; 
            ctx.setLineDash([5, 5]); 
            ctx.moveTo(50, limitY); 
            ctx.lineTo(canvas.width - 50, limitY); 
            ctx.stroke(); 
            ctx.setLineDash([]); 
        }

        function drawFunctionInfinity(ctx, canvas) { 
            drawArctan(ctx, canvas); 
        }

        function drawOneOverX(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas); 
            ctx.strokeStyle = '#3498db'; 
            ctx.lineWidth = 2; 
            ctx.beginPath(); 
            for (let x_val = 0.1; x_val <= 5; x_val += 0.05) { 
                const x = canvas.width / 2 + x_val * 50; 
                const y = canvas.height / 2 - (1 / x_val) * 50; 
                if (x_val === 0.1) ctx.moveTo(x, y); 
                else ctx.lineTo(x, y); 
            } 
            ctx.stroke(); 
            ctx.beginPath(); 
            for (let x_val = -5; x_val <= -0.1; x_val += 0.05) { 
                const x = canvas.width / 2 + x_val * 50; 
                const y = canvas.height / 2 - (1 / x_val) * 50; 
                if (x_val === -5) ctx.moveTo(x, y); 
                else ctx.lineTo(x, y); 
            } 
            ctx.stroke(); 
        }

        function drawArctan(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas); 
            ctx.strokeStyle = '#9b59b6'; 
            ctx.lineWidth = 2; 
            ctx.beginPath(); 
            for (let x_val = -10; x_val <= 10; x_val += 0.1) { 
                const x = canvas.width / 2 + x_val * 25; 
                const y = canvas.height / 2 - Math.atan(x_val) * 80; 
                if (x_val === -10) ctx.moveTo(x, y); 
                else ctx.lineTo(x, y); 
            } 
            ctx.stroke(); 
            ctx.strokeStyle = '#e74c3c'; 
            ctx.setLineDash([5, 5]); 
            const y_plus = canvas.height / 2 - (Math.PI / 2) * 80; 
            const y_minus = canvas.height / 2 + (Math.PI / 2) * 80; 
            ctx.moveTo(50, y_plus); 
            ctx.lineTo(canvas.width - 50, y_plus); 
            ctx.stroke(); 
            ctx.moveTo(50, y_minus); 
            ctx.lineTo(canvas.width - 50, y_minus); 
            ctx.stroke(); 
            ctx.setLineDash([]); 
        }

        function drawShadowAnimation(ctx, canvas) { 
            let personX = 100; 
            function animate() { 
                ctx.clearRect(0, 0, canvas.width, canvas.height); 
                const lightX = canvas.width / 2; 
                const lightY = 50; 
                const personHeight = 80; 
                const groundY = 350; 
                ctx.fillStyle = '#f39c12'; 
                ctx.beginPath(); 
                ctx.arc(lightX, lightY, 15, 0, 2*Math.PI); 
                ctx.fill(); 
                ctx.fillStyle = '#3498db'; 
                ctx.fillRect(personX - 10, groundY - personHeight, 20, personHeight); 
                const shadowEndX = lightX - (lightX - personX) * (lightY / (lightY - (groundY-personHeight))); 
                ctx.strokeStyle = '#7f8c8d'; 
                ctx.setLineDash([3,3]); 
                ctx.beginPath(); 
                ctx.moveTo(lightX, lightY); 
                ctx.lineTo(personX, groundY - personHeight); 
                ctx.stroke(); 
                ctx.setLineDash([]); 
                ctx.fillStyle = 'rgba(0,0,0,0.4)'; 
                ctx.beginPath(); 
                ctx.ellipse( (personX + shadowEndX) / 2, groundY, Math.abs(personX - shadowEndX)/2, 5, 0, 0, 2*Math.PI); 
                ctx.fill(); 
                personX += 0.5; 
                if(personX > canvas.width - 50) personX = 50; 
                animationFrameId = requestAnimationFrame(animate); 
            } 
            animate(); 
        }

        function drawPointLimit(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas); 
            const x0 = canvas.width / 2; 
            const y0 = canvas.height / 2 - 80; 
            ctx.strokeStyle = '#3498db'; 
            ctx.lineWidth = 2; 
            ctx.beginPath(); 
            for (let x_val = -2.5; x_val <= 2.5; x_val += 0.1) { 
                const x = x0 + x_val * 80; 
                const y = y0 - (x_val * x_val - 1) * 30; 
                if (Math.abs(x_val) > 0.1) { 
                    if (x_val === -2.5) ctx.moveTo(x, y); 
                    else ctx.lineTo(x, y); 
                } 
            } 
            ctx.stroke(); 
            ctx.beginPath(); 
            ctx.arc(x0, y0 + 30, 5, 0, 2 * Math.PI); 
            ctx.fillStyle = 'white'; 
            ctx.fill(); 
            ctx.strokeStyle = '#e74c3c'; 
            ctx.stroke(); 
        }

        function drawVelocity(ctx, canvas) { 
            let t=0; 
            function animate() { 
                ctx.clearRect(0,0,canvas.width, canvas.height); 
                const g = 9.8; 
                const y = 50 + 0.5 * g * t*t * 10; 
                if (y > canvas.height - 20) t=0; 
                ctx.fillStyle = '#3498db'; 
                ctx.beginPath(); 
                ctx.arc(canvas.width/2, y, 20, 0, 2*Math.PI); 
                ctx.fill(); 
                t += 0.05; 
                animationFrameId = requestAnimationFrame(animate); 
            } 
            animate(); 
        }

        function drawLeftRightLimits(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas); 
            const x0 = canvas.width/2; 
            const y0 = canvas.height/2; 
            ctx.strokeStyle = '#3498db'; 
            ctx.lineWidth=2; 
            ctx.beginPath(); 
            ctx.moveTo(50, y0+50); 
            ctx.lineTo(x0, y0+20); 
            ctx.stroke(); 
            ctx.strokeStyle = '#2ecc71'; 
            ctx.beginPath(); 
            ctx.moveTo(x0, y0-20); 
            ctx.lineTo(canvas.width-50, y0-50); 
            ctx.stroke(); 
            ctx.beginPath(); 
            ctx.arc(x0, y0+20, 5, 0, 2*Math.PI); 
            ctx.stroke(); 
            ctx.beginPath(); 
            ctx.arc(x0, y0-20, 5, 0, 2*Math.PI); 
            ctx.stroke(); 
        }

        function drawPiecewise1(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas, {x_origin: 100}); 
            const x1 = 100 + 1 * 50; 
            ctx.strokeStyle = '#3498db'; 
            ctx.lineWidth=2; 
            ctx.beginPath(); 
            ctx.moveTo(100 - 2*50, 300); 
            ctx.lineTo(x1, 150); 
            ctx.stroke(); 
            ctx.strokeStyle = '#2ecc71'; 
            ctx.beginPath(); 
            ctx.moveTo(x1, 150); 
            ctx.lineTo(100+5*50, 50); 
            ctx.stroke(); 
            ctx.fillStyle='#e74c3c'; 
            ctx.beginPath(); 
            ctx.arc(x1, 150, 5, 0, 2*Math.PI); 
            ctx.fill(); 
        }

        function drawPiecewise2(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas); 
            const x0 = canvas.width/2; 
            const y0 = canvas.height/2; 
            ctx.strokeStyle = '#3498db'; 
            ctx.lineWidth=2; 
            ctx.beginPath(); 
            ctx.moveTo(x0 - 100, y0+50); 
            ctx.lineTo(x0, y0); 
            ctx.stroke(); 
            ctx.strokeStyle = '#2ecc71'; 
            ctx.beginPath(); 
            ctx.moveTo(x0, y0); 
            ctx.quadraticCurveTo(x0+50, y0-20, x0+100, y0-100); 
            ctx.stroke(); 
            ctx.beginPath(); 
            ctx.arc(x0, y0, 5, 0, 2*Math.PI); 
            ctx.fillStyle='white'; 
            ctx.fill(); 
            ctx.stroke(); 
        }

        function drawInfinitesimalConcept(ctx, canvas) { 
            let scale = 1; 
            function animate() { 
                ctx.clearRect(0,0,canvas.width,canvas.height); 
                drawCoordinateSystem(ctx, canvas); 
                ctx.strokeStyle = '#3498db'; 
                ctx.lineWidth=2; 
                ctx.beginPath(); 
                for(let x_val=-3; x_val<=3; x_val+=0.1){
                    const x = canvas.width/2 + x_val*80; 
                    const y = canvas.height/2 - Math.exp(-x_val*x_val)*100*scale; 
                    if(x_val===-3)ctx.moveTo(x,y); 
                    else ctx.lineTo(x,y);
                } 
                ctx.stroke(); 
                scale *= 0.99; 
                if(scale < 0.01) scale = 1; 
                animationFrameId=requestAnimationFrame(animate);
            } 
            animate(); 
        }

        function drawInfinitesimalProperties(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas);
            ctx.strokeStyle = '#3498db';
            ctx.lineWidth = 1.5;
            
            // ç»˜åˆ¶ 1/x (æ— ç©·å°)
            ctx.beginPath();
            for(let x_val = 0.1; x_val <= 5; x_val += 0.05) {
                const x = canvas.width/2 + x_val * 60;
                const y = canvas.height/2 - (1/x_val) * 20;
                if(x_val === 0.1) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();
            
            // ç»˜åˆ¶ cos(x) (æœ‰ç•Œå‡½æ•°)
            ctx.strokeStyle = '#e74c3c';
            ctx.beginPath();
            for(let x_val = 0.1; x_val <= 5; x_val += 0.05) {
                const x = canvas.width/2 + x_val * 60;
                const y = canvas.height/2 - Math.cos(x_val) * 30;
                if(x_val === 0.1) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();
            
            // ç»˜åˆ¶ä¹˜ç§¯ (1/x)*cos(x)
            ctx.strokeStyle = '#2ecc71';
            ctx.lineWidth = 2;
            ctx.beginPath();
            for(let x_val = 0.1; x_val <= 5; x_val += 0.05) {
                const x = canvas.width/2 + x_val * 60;
                const y = canvas.height/2 - (Math.cos(x_val)/x_val) * 20;
                if(x_val === 0.1) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();
        }

        function drawInfiniteConcept(ctx, canvas) { 
            drawOneOverX(ctx, canvas); 
        }

        function drawLimitProperties(ctx, canvas) { 
            const props=['å”¯ä¸€æ€§', 'æœ‰ç•Œæ€§', 'ä¿å·æ€§']; 
            props.forEach((p, i) => { 
                ctx.fillStyle = `hsl(${i*120}, 70%, 50%)`; 
                ctx.fillRect(50 + i*180, 150, 150, 100); 
                ctx.fillStyle='white'; 
                ctx.font='20px Arial'; 
                ctx.textAlign='center'; 
                ctx.fillText(p, 125+i*180, 205); 
            }); 
        }

        function drawLimitRules(ctx, canvas) { 
            ctx.font = '24px Arial';
            ctx.textAlign = 'center';
            ctx.fillStyle = '#2c3e50';
            
            // ç»˜åˆ¶è¿ç®—æ³•åˆ™å›¾ç¤º
            ctx.fillText('lim[f(x) Â± g(x)] = A Â± B', canvas.width/2, 120);
            ctx.fillText('lim[f(x) Â· g(x)] = A Â· B', canvas.width/2, 180);
            ctx.fillText('lim[f(x)/g(x)] = A/B (Bâ‰ 0)', canvas.width/2, 240);
            
            // ç»˜åˆ¶ç¤ºæ„å›¾
            ctx.strokeStyle = '#3498db';
            ctx.lineWidth = 3;
            drawArrow(ctx, 150, 300, 200, 300);
            ctx.fillText('A', 175, 330);
            
            ctx.strokeStyle = '#e74c3c';
            drawArrow(ctx, 300, 300, 350, 300);
            ctx.fillText('B', 325, 330);
            
            ctx.strokeStyle = '#2ecc71';
            drawArrow(ctx, 450, 300, 500, 300);
            ctx.fillText('Aâ—¦B', 475, 330);
        }

        function drawDirectSubstitution(ctx, canvas) { 
            ctx.font = '28px Arial';
            ctx.textAlign = 'center';
            ctx.fillStyle = '#2c3e50';
            
            ctx.fillText('ç›´æ¥ä»£å…¥æ³•', canvas.width/2, 80);
            
            // ç¤ºä¾‹
            ctx.font = '20px Arial';
            ctx.fillText('å¦‚æœ f(x) åœ¨ xâ‚€ å¤„è¿ç»­', canvas.width/2, 140);
            ctx.fillText('åˆ™ lim f(x) = f(xâ‚€)', canvas.width/2, 180);
            ctx.fillText('xâ†’xâ‚€', canvas.width/2, 200);
            
            // ç»˜åˆ¶è¿ç»­å‡½æ•°å›¾åƒ
            drawCoordinateSystem(ctx, canvas);
            ctx.strokeStyle = '#3498db';
            ctx.lineWidth = 3;
            ctx.beginPath();
            for(let x = -3; x <= 3; x += 0.1) {
                const canvasX = canvas.width/2 + x * 60;
                const canvasY = canvas.height/2 - (x*x - 1) * 20;
                if(x === -3) ctx.moveTo(canvasX, canvasY);
                else ctx.lineTo(canvasX, canvasY);
            }
            ctx.stroke();
            
            // æ ‡è®°ç‚¹
            ctx.fillStyle = '#e74c3c';
            ctx.beginPath();
            ctx.arc(canvas.width/2, canvas.height/2 + 20, 6, 0, 2*Math.PI);
            ctx.fill();
        }

        function drawZeroOverZero(ctx, canvas) { 
            let pos = 0; 
            let dir = 1; 
            function animate(){ 
                ctx.clearRect(0,0,canvas.width,canvas.height); 
                ctx.fillStyle='#3498db'; 
                ctx.font='40px Arial'; 
                ctx.textAlign='center'; 
                ctx.fillText('åˆ†å­ â†’ 0', 150, 200); 
                ctx.fillStyle='#e74c3c'; 
                ctx.fillText('åˆ†æ¯ â†’ 0', 450, 200); 
                ctx.font='80px Arial'; 
                ctx.fillStyle='#9b59b6'; 
                ctx.fillText('?', canvas.width/2, 200 + pos); 
                pos += dir; 
                if(pos > 20 || pos < -20) dir *= -1; 
                animationFrameId = requestAnimationFrame(animate); 
            } 
            animate(); 
        }

        function drawRationalization(ctx, canvas) { 
            ctx.font = '24px Arial';
            ctx.textAlign = 'center';
            ctx.fillStyle = '#2c3e50';
            
            ctx.fillText('æœ‰ç†åŒ–æ–¹æ³•', canvas.width/2, 80);
            
            // å±•ç¤ºæœ‰ç†åŒ–è¿‡ç¨‹
            ctx.font = '18px Arial';
            ctx.fillText('âˆš(a) - âˆš(b)', canvas.width/2, 140);
            ctx.fillText('Ã—', canvas.width/2, 180);
            ctx.fillText('âˆš(a) + âˆš(b)', canvas.width/2, 220);
            ctx.fillText('= a - b', canvas.width/2, 280);
            
            // ç»˜åˆ¶ä¹˜æ³•ç¬¦å·
            ctx.strokeStyle = '#e74c3c';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(canvas.width/2 - 20, 160);
            ctx.lineTo(canvas.width/2 + 20, 200);
            ctx.moveTo(canvas.width/2 + 20, 160);
            ctx.lineTo(canvas.width/2 - 20, 200);
            ctx.stroke();
            
            // ç»˜åˆ¶ä¸‹åˆ’çº¿
            ctx.beginPath();
            ctx.moveTo(canvas.width/2 - 80, 240);
            ctx.lineTo(canvas.width/2 + 80, 240);
            ctx.stroke();
        }

        function drawInfinityOverInfinity(ctx, canvas) { 
            let t=0; 
            function animate(){ 
                ctx.clearRect(0,0,canvas.width,canvas.height); 
                ctx.fillStyle='#3498db'; 
                ctx.fillRect(50, 150, 50+t*5, 30); 
                ctx.fillText('xÂ²', 20, 170); 
                ctx.fillStyle='#2ecc71'; 
                ctx.fillRect(50, 250, 50+t*2, 30); 
                ctx.fillText('x', 20, 270); 
                
                // æ·»åŠ è¯´æ˜æ–‡å­—
                ctx.font = '20px Arial';
                ctx.textAlign = 'center';
                ctx.fillStyle = '#2c3e50';
                ctx.fillText('æœ€é«˜æ¬¡é¡¹çš„å¢é•¿æ¯”è¾ƒ', canvas.width/2, 100);
                
                t+=0.5; 
                if(50+t*5 > canvas.width) t=0; 
                animationFrameId=requestAnimationFrame(animate); 
            } 
            animate(); 
        }

        function drawSinXOverX(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas); 
            ctx.strokeStyle = '#3498db'; 
            ctx.lineWidth = 2; 
            ctx.beginPath(); 
            for (let x_val = -10; x_val <= 10; x_val += 0.1) { 
                const x = canvas.width / 2 + x_val * 25; 
                const y_val = x_val === 0 ? 1 : Math.sin(x_val) / x_val; 
                const y = canvas.height / 2 - y_val * 100; 
                if (x_val === -10) ctx.moveTo(x, y); 
                else ctx.lineTo(x, y); 
            } 
            ctx.stroke(); 
            ctx.beginPath(); 
            ctx.arc(canvas.width / 2, canvas.height / 2 - 100, 5, 0, 2 * Math.PI); 
            ctx.fillStyle = 'white'; 
            ctx.fill(); 
            ctx.strokeStyle = '#e74c3c'; 
            ctx.stroke(); 
        }

        function drawELimit(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas); 
            ctx.strokeStyle = '#2ecc71'; 
            ctx.beginPath(); 
            for (let x_val = 1; x_val < 50; x_val++) { 
                const y_val = Math.pow(1 + 1 / x_val, x_val); 
                const x = 50 + x_val * 10; 
                const y = canvas.height - 50 - (y_val - 2) * 200; 
                if (x_val === 1) ctx.moveTo(x, y); 
                else ctx.lineTo(x, y); 
            } 
            ctx.stroke(); 
            const e_y = canvas.height - 50 - (Math.E - 2) * 200; 
            ctx.strokeStyle = '#e74c3c'; 
            ctx.setLineDash([5, 5]); 
            ctx.moveTo(50, e_y); 
            ctx.lineTo(canvas.width - 50, e_y); 
            ctx.stroke(); 
            ctx.setLineDash([]); 
        }

        function drawInfinitesimalComparison(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas); 
            const funcs = [
                {f:x=>x, c:'#3498db', name:'x'}, 
                {f:x=>x*x, c:'#2ecc71', name:'xÂ²'}, 
                {f:x=>x*x*x, c:'#e74c3c', name:'xÂ³'}
            ]; 
            funcs.forEach((fn, i) => { 
                ctx.strokeStyle = fn.c; 
                ctx.lineWidth = 2; 
                ctx.beginPath(); 
                for(let x_val = -2; x_val <= 2; x_val+=0.05){
                    const x=canvas.width/2+x_val*80; 
                    const y=canvas.height/2-fn.f(x_val)*40; 
                    if(x_val===-2)ctx.moveTo(x,y); 
                    else ctx.lineTo(x,y);
                } 
                ctx.stroke(); 
                
                // æ·»åŠ æ ‡ç­¾
                ctx.fillStyle = fn.c;
                ctx.font = '16px Arial';
                ctx.fillText(fn.name, 50 + i*60, 50);
            }); 
        }

        function drawEquivalentInfinitesimal(ctx, canvas) { 
            drawCoordinateSystem(ctx, canvas); 
            ctx.strokeStyle = '#3498db'; 
            ctx.lineWidth = 2; 
            ctx.beginPath(); 
            for(let x_val=-2;x_val<=2;x_val+=0.05){
                const x=canvas.width/2+x_val*80;
                const y=canvas.height/2-Math.sin(x_val)*80;
                if(x_val===-2)ctx.moveTo(x,y);
                else ctx.lineTo(x,y);
            } 
            ctx.stroke(); 
            ctx.strokeStyle = '#e74c3c'; 
            ctx.setLineDash([5,5]); 
            ctx.beginPath(); 
            ctx.moveTo(canvas.width/2-160, canvas.height/2+160); 
            ctx.lineTo(canvas.width/2+160, canvas.height/2-160); 
            ctx.stroke(); 
            ctx.setLineDash([]); 
            
            // æ·»åŠ æ ‡ç­¾
            ctx.font = '16px Arial';
            ctx.fillStyle = '#3498db';
            ctx.fillText('sin(x)', 50, 50);
            ctx.fillStyle = '#e74c3c';
            ctx.fillText('x', 50, 80);
        }

        function drawContinuityConcept(ctx, canvas) {
            drawCoordinateSystem(ctx, canvas);
            let x = 100;
            let y = 250;
            function animate(){
                ctx.clearRect(0,0,canvas.width,canvas.height);
                drawCoordinateSystem(ctx, canvas);
                ctx.strokeStyle='#3498db';
                ctx.lineWidth=2;
                ctx.beginPath();
                ctx.moveTo(50, 300);
                ctx.quadraticCurveTo(300, 100, 550, 300);
                ctx.stroke();
                ctx.fillStyle = '#e74c3c';
                ctx.beginPath();
                const cur_y = 300 - 0.0025 * (x-300)*(x-300);
                ctx.arc(x, cur_y, 5, 0, 2*Math.PI);
                ctx.fill();
                x += 1;
                if(x > 550) x=50;
                animationFrameId = requestAnimationFrame(animate);
            }
            animate();
        }

        function drawContinuityDefinition(ctx, canvas) {
            drawContinuityConcept(ctx, canvas);
        }

        function drawIceMelting(ctx, canvas) {
            drawCoordinateSystem(ctx, canvas, {x_origin: 100});
            const x0=100;
            const y0=canvas.height/2;
            ctx.strokeStyle='#3498db';
            ctx.lineWidth=2;
            ctx.beginPath();
            ctx.moveTo(50, y0+50);
            ctx.lineTo(x0, y0);
            ctx.stroke();
            ctx.strokeStyle='#e74c3c';
            ctx.beginPath();
            ctx.moveTo(x0, y0-80);
            ctx.lineTo(550, y0-120);
            ctx.stroke();
        }

        function drawDiscontinuityTypes(ctx, canvas) {
            drawFirstDiscontinuity(ctx, canvas);
        }

        function drawFirstDiscontinuity(ctx, canvas) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const x0 = canvas.width / 2;
            const y_rem = canvas.height / 4;
            const y_jump = canvas.height * 3 / 4;
            ctx.strokeStyle = '#3498db';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(50, y_rem);
            ctx.lineTo(x0 - 5, y_rem);
            ctx.moveTo(x0 + 5, y_rem);
            ctx.lineTo(canvas.width - 50, y_rem);
            ctx.stroke();
            ctx.beginPath();
            ctx.arc(x0, y_rem, 4, 0, 2 * Math.PI);
            ctx.stroke();
            ctx.font = '14px Arial';
            ctx.fillText('å¯å»é—´æ–­ç‚¹', x0, y_rem + 20);
            ctx.beginPath();
            ctx.moveTo(50, y_jump + 20);
            ctx.lineTo(x0, y_jump + 20);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(x0, y_jump - 20);
            ctx.lineTo(canvas.width - 50, y_jump - 20);
            ctx.stroke();
            ctx.fillText('è·³è·ƒé—´æ–­ç‚¹', x0, y_jump + 40);
        }

        function drawSecondDiscontinuity(ctx, canvas) {
            drawCoordinateSystem(ctx, canvas);
            const x0 = canvas.width / 2;
            ctx.strokeStyle = '#e74c3c';
            ctx.setLineDash([5, 5]);
            ctx.moveTo(x0, 0);
            ctx.lineTo(x0, canvas.height);
            ctx.stroke();
            ctx.setLineDash([]);
            ctx.strokeStyle = '#9b59b6';
            ctx.lineWidth = 2;
            ctx.beginPath();
            for(let x_val=0.1; x_val<=3; x_val+=0.05){
                const x=x0+x_val*50;
                const y=canvas.height/2- (1/x_val)*50;
                if(x_val===0.1)ctx.moveTo(x,y);
                else ctx.lineTo(x,y);
            }
            ctx.stroke();
        }

        function drawElementaryContinuity(ctx, canvas) {
            drawDefaultAnimation(ctx, canvas);
        }

        function drawExercise1(ctx, canvas) {
            drawDefaultAnimation(ctx, canvas);
        }

        function drawExercise2(ctx, canvas) {
            drawDefaultAnimation(ctx, canvas);
        }

        function drawSummaryAnimation(ctx, canvas) {
            let t = 0;
            const icons = ['ğŸ¯', 'ğŸ“ˆ', 'ğŸ¤', 'ğŸ”‘'];
            function animate() {
                t += 0.01;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.save();
                ctx.translate(canvas.width / 2, canvas.height / 2);
                ctx.font = '100px sans-serif';
                ctx.textAlign = 'center';
                const iconIndex = Math.floor(t) % icons.length;
                const scale = 1 + 0.1 * Math.sin(t * 5);
                ctx.scale(scale, scale);
                ctx.fillText(icons[iconIndex], 0, 0);
                ctx.restore();
                animationFrameId = requestAnimationFrame(animate);
            }
            animate();
        }
        function drawViewShift(ctx, canvas) {
            drawDefaultAnimation(ctx, canvas);
            ctx.fillStyle = '#3b82f6';
            ctx.fillRect(80, 120, 160, 160);
            ctx.fillStyle = '#ffffff';
            ctx.font = '20px Microsoft YaHei';
            ctx.textAlign = 'center';
            ctx.fillText('é«˜ä¸­', 160, 200);
            ctx.fillStyle = '#10b981';
            ctx.fillRect(canvas.width - 240, 120, 160, 160);
            ctx.fillStyle = '#ffffff';
            ctx.fillText('å¤§å­¦', canvas.width - 160, 200);
        }

        function drawTerminalBehaviors(ctx, canvas) {
            drawDefaultAnimation(ctx, canvas);
            ctx.strokeStyle = '#10b981';
            ctx.beginPath();
            for (let n = 1; n <= 10; n++) {
                const x = 60 + n * 40;
                const y = canvas.height - 80 - (1 - 1 / n) * 150;
                ctx.lineTo(x, y);
            }
            ctx.stroke();
            ctx.strokeStyle = '#ef4444';
            ctx.beginPath();
            for (let n = 1; n <= 10; n++) {
                const x = 60 + n * 40;
                const y = canvas.height - 80 - (n / 10) * 200;
                ctx.lineTo(x, y);
            }
            ctx.stroke();
            ctx.strokeStyle = '#f59e0b';
            ctx.beginPath();
            for (let n = 1; n <= 10; n++) {
                const x = 60 + n * 40;
                const y = canvas.height / 2 - Math.sin(n) * 80;
                ctx.lineTo(x, y);
            }
            ctx.stroke();
        }

        function drawSequenceFunction(ctx, canvas) {
            drawCoordinateSystem(ctx, canvas, { mode: 'quadrant' });
            ctx.fillStyle = '#6366f1';
            for (let n = 1; n <= 8; n++) {
                const x = 60 + n * 60;
                const y = canvas.height - 80 - (n / (n + 1)) * 180;
                ctx.beginPath();
                ctx.arc(x, y, 6, 0, 2 * Math.PI);
                ctx.fill();
            }
        }

        function drawDomainApproach(ctx, canvas) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.strokeStyle = '#94a3b8';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(60, canvas.height / 3);
            ctx.lineTo(canvas.width - 60, canvas.height / 3);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(60, (canvas.height * 2) / 3);
            ctx.lineTo(canvas.width - 60, (canvas.height * 2) / 3);
            ctx.stroke();
            ctx.fillStyle = '#1d4ed8';
            ctx.font = '18px Microsoft YaHei';
            ctx.fillText('n = 1,2,3,... â†’ åªå¾€å³', canvas.width / 2, canvas.height / 3 - 20);
            ctx.fillText('x âˆˆ â„ â†’ å·¦ã€å³ã€Â±âˆ', canvas.width / 2, (canvas.height * 2) / 3 - 20);
        }

        function drawLeftLimitViz(ctx, canvas) {
            drawCoordinateSystem(ctx, canvas);
            ctx.strokeStyle = '#3b82f6';
            ctx.beginPath();
            ctx.moveTo(60, canvas.height / 2);
            ctx.lineTo(canvas.width / 2, canvas.height / 2);
            ctx.stroke();
            drawArrow(ctx, canvas.width / 2 - 80, canvas.height / 2 - 40, canvas.width / 2 - 10, canvas.height / 2);
        }

        function drawRightLimitViz(ctx, canvas) {
            drawCoordinateSystem(ctx, canvas);
            ctx.strokeStyle = '#10b981';
            ctx.beginPath();
            ctx.moveTo(canvas.width / 2, canvas.height / 2);
            ctx.lineTo(canvas.width - 60, canvas.height / 2);
            ctx.stroke();
            drawArrow(ctx, canvas.width / 2 + 80, canvas.height / 2 - 40, canvas.width / 2 + 10, canvas.height / 2);
        }

        function drawLimitConvergenceViz(ctx, canvas) {
            drawCoordinateSystem(ctx, canvas);
            drawArrow(ctx, 80, canvas.height / 2 - 40, canvas.width / 2 - 10, canvas.height / 2, '#3b82f6');
            drawArrow(ctx, canvas.width - 80, canvas.height / 2 + 40, canvas.width / 2 + 10, canvas.height / 2, '#10b981');
            ctx.fillStyle = '#ef4444';
            ctx.beginPath();
            ctx.arc(canvas.width / 2, canvas.height / 2, 6, 0, 2 * Math.PI);
            ctx.fill();
        }

        function drawInfinitesimalFramework(ctx, canvas) {
            drawDefaultAnimation(ctx, canvas);
            ctx.fillStyle = '#2563eb';
            ctx.font = '18px Microsoft YaHei';
            ctx.fillText('æ¯”è¾ƒ lim Î²/Î± â†’ åˆ†ç±»', canvas.width / 2, canvas.height / 2);
        }

        function drawHigherInfinitesimal(ctx, canvas) {
            drawCoordinateSystem(ctx, canvas);
            ctx.strokeStyle = '#2563eb';
            ctx.beginPath();
            for (let x = -2; x <= 2; x += 0.05) {
                const canvasX = canvas.width / 2 + x * 80;
                const canvasY = canvas.height / 2 - (x * x) * 60;
                if (x === -2) ctx.moveTo(canvasX, canvasY);
                else ctx.lineTo(canvasX, canvasY);
            }
            ctx.stroke();
            ctx.strokeStyle = '#94a3b8';
            ctx.beginPath();
            for (let x = -2; x <= 2; x += 0.05) {
                const canvasX = canvas.width / 2 + x * 80;
                const canvasY = canvas.height / 2 - x * 60;
                if (x === -2) ctx.moveTo(canvasX, canvasY);
                else ctx.lineTo(canvasX, canvasY);
            }
            ctx.stroke();
        }

        function drawLowerInfinitesimal(ctx, canvas) {
            drawHigherInfinitesimal(ctx, canvas);
        }

        function drawSameOrderInfinitesimal(ctx, canvas) {
            drawCoordinateSystem(ctx, canvas);
            ctx.strokeStyle = '#2563eb';
            ctx.beginPath();
            for (let x = -2; x <= 2; x += 0.05) {
                const canvasX = canvas.width / 2 + x * 80;
                const canvasY = canvas.height / 2 - x * 60;
                if (x === -2) ctx.moveTo(canvasX, canvasY);
                else ctx.lineTo(canvasX, canvasY);
            }
            ctx.stroke();
            ctx.strokeStyle = '#16a34a';
            ctx.beginPath();
            for (let x = -2; x <= 2; x += 0.05) {
                const canvasX = canvas.width / 2 + x * 80;
                const canvasY = canvas.height / 2 - (0.5 * x) * 60;
                if (x === -2) ctx.moveTo(canvasX, canvasY);
                else ctx.lineTo(canvasX, canvasY);
            }
            ctx.stroke();
        }

        function drawContinuityIntro(ctx, canvas) {
            drawDefaultAnimation(ctx, canvas);
            ctx.fillStyle = '#14b8a6';
            ctx.font = '20px Microsoft YaHei';
            ctx.textAlign = 'center';
            ctx.fillText('ç›´æ¥ä»£å…¥æ³•æˆç«‹ â† å‡½æ•°åœ¨ç‚¹ä¸Šå¤Ÿâ€œå¹³æ»‘â€', canvas.width / 2, canvas.height / 2);
        }

        function drawContinuityThree(ctx, canvas) {
            drawDefaultAnimation(ctx, canvas);
            ctx.fillStyle = '#2563eb';
            ctx.font = '18px Microsoft YaHei';
            ctx.fillText('â‘  å‡½æ•°å€¼å­˜åœ¨  â‘¡ æé™å­˜åœ¨  â‘¢ æé™=å‡½æ•°å€¼', canvas.width / 2, canvas.height / 2);
        }

        function drawDiscontinuityDiagnose(ctx, canvas) {
            drawDefaultAnimation(ctx, canvas);
            ctx.fillStyle = '#ef4444';
            ctx.font = '18px Microsoft YaHei';
            ctx.fillText('å¯å» Â· è·³è·ƒ Â· æ— ç©· â€”â€” æ‰¾å‡ºç¼ºå¤±æ¡ä»¶', canvas.width / 2, canvas.height / 2);
        }
        // è¾…åŠ©å‡½æ•°
        function drawCoordinateSystem(ctx, canvas, options = {}) {
            const width = canvas.width;
            const height = canvas.height;
            const mode = options.mode || (options.center ? 'center' : 'center');
            const padding = options.padding ?? 50;
            const axisColor = options.axisColor ?? '#d1d5db';
            const lineWidth = options.lineWidth ?? 1.2;
            const originX = options.x_origin ?? options.originX ?? (mode === 'quadrant' ? padding : width / 2);
            const originY = options.y_origin ?? options.originY ?? (mode === 'quadrant' ? height - padding : height / 2);
            const showTicks = options.showTicks !== false;
            const tickLength = options.tickLength ?? 6;
            const xTickStep = options.xTickStep ?? 60;
            const yTickStep = options.yTickStep ?? 60;

            ctx.save();
            ctx.strokeStyle = axisColor;
            ctx.lineWidth = lineWidth;

            ctx.beginPath();
            ctx.moveTo(0, originY);
            ctx.lineTo(width, originY);
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo(originX, 0);
            ctx.lineTo(originX, height);
            ctx.stroke();

            if (showTicks) {
                ctx.lineWidth = 1;
                ctx.beginPath();
                for (let x = originX + xTickStep; x < width; x += xTickStep) {
                    ctx.moveTo(x, originY - tickLength);
                    ctx.lineTo(x, originY + tickLength);
                }
                if (mode !== 'quadrant') {
                    for (let x = originX - xTickStep; x > 0; x -= xTickStep) {
                        ctx.moveTo(x, originY - tickLength);
                        ctx.lineTo(x, originY + tickLength);
                    }
                }
                for (let y = originY - yTickStep; y > 0; y -= yTickStep) {
                    ctx.moveTo(originX - tickLength, y);
                    ctx.lineTo(originX + tickLength, y);
                }
                if (mode === 'center') {
                    for (let y = originY + yTickStep; y < height; y += yTickStep) {
                        ctx.moveTo(originX - tickLength, y);
                        ctx.lineTo(originX + tickLength, y);
                    }
                }
                ctx.stroke();
            }

            ctx.restore();
        }

        function drawArrow(ctx, fromX, fromY, toX, toY, color = '#e74c3c', width = 2) {
            const headlen = 10;
            const angle = Math.atan2(toY - fromY, toX - fromX);
            ctx.save();
            ctx.strokeStyle = color;
            ctx.lineWidth = width;
            ctx.beginPath();
            ctx.moveTo(fromX, fromY);
            ctx.lineTo(toX, toY);
            ctx.lineTo(toX - headlen * Math.cos(angle - Math.PI / 6), toY - headlen * Math.sin(angle - Math.PI / 6));
            ctx.moveTo(toX, toY);
            ctx.lineTo(toX - headlen * Math.cos(angle + Math.PI / 6), toY - headlen * Math.sin(angle + Math.PI / 6));
            ctx.stroke();
            ctx.restore();
        }

        // Step Stack Management Functions
        function showStep(stackId, stepNumber) {
            const stack = document.getElementById(stackId);
            if (!stack) return;

            // Hide all steps
            const steps = stack.querySelectorAll('.step-item');
            steps.forEach(step => {
                step.classList.remove('active');
            });

            // Show target step
            const targetStep = stack.querySelector(`[data-step="${stepNumber}"]`);
            if (targetStep) {
                targetStep.classList.add('active');

                // Mark previous steps as completed
                steps.forEach(step => {
                    const stepNum = parseInt(step.dataset.step);
                    if (stepNum < stepNumber) {
                        step.classList.add('completed');
                    } else {
                        step.classList.remove('completed');
                    }
                });

                // Re-render MathJax for new content
                if (window.MathJax && window.MathJax.typesetPromise) {
                    queueMathTypeset(targetStep).then((success) => {
                        if (!success) {
                            console.warn('æ­¥éª¤å†…å®¹çš„å…¬å¼æ¸²æŸ“æœªæˆåŠŸ');
                        }
                    });
                }

                // Update animation based on step
                updateAnimationForStep(stackId, stepNumber);
            }
        }

        function updateAnimationForStep(stackId, stepNumber) {
            // This function can be expanded to show different animations based on the step
            const canvas = document.getElementById('animationCanvas');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');

            // Clear previous animation
            if (window.animationFrameId) {
                cancelAnimationFrame(window.animationFrameId);
            }

            // Draw step-specific animation
            switch(stackId) {
                case 'sequence-intro':
                    drawSequenceStepAnimation(ctx, canvas, stepNumber);
                    break;
                case 'trend-observation':
                    drawTrendStepAnimation(ctx, canvas, stepNumber);
                    break;
                case 'limit-definition':
                    drawLimitStepAnimation(ctx, canvas, stepNumber);
                    break;
                default:
                    drawDefaultAnimation(ctx, canvas);
            }
        }

        function drawSequenceStepAnimation(ctx, canvas, step) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.font = '20px Arial';
            ctx.textAlign = 'center';

            switch(step) {
                case 1:
                    // Show building floors
                    ctx.fillStyle = '#3498db';
                    for (let i = 0; i < 5; i++) {
                        ctx.fillRect(canvas.width/2 - 30, canvas.height - 50 - i*40, 60, 35);
                        ctx.fillStyle = '#2c3e50';
                        ctx.fillText(`${i+1}F`, canvas.width/2, canvas.height - 30 - i*40);
                        ctx.fillStyle = '#3498db';
                    }
                    break;
                case 2:
                    // Show mathematical sequence
                    ctx.fillStyle = '#2c3e50';
                    const sequence = ['xâ‚', 'xâ‚‚', 'xâ‚ƒ', '...', 'xâ‚™'];
                    for (let i = 0; i < sequence.length; i++) {
                        ctx.fillText(sequence[i], 50 + i*80, canvas.height/2);
                    }
                    break;
                case 3:
                    // Show correct vs incorrect examples
                    ctx.fillStyle = '#e74c3c';
                    ctx.fillText('âŒ åªèƒ½æ˜¯ 1,2,3,4...', canvas.width/2, canvas.height/2 - 30);
                    ctx.fillStyle = '#27ae60';
                    ctx.fillText('âœ… å¯ä»¥æ˜¯ 1,4,9,16...', canvas.width/2, canvas.height/2 + 30);
                    break;
            }
        }

        function drawTrendStepAnimation(ctx, canvas, step) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            switch(step) {
                case 1:
                    // Show calculation results
                    drawCoordinateSystem(ctx, canvas, { mode: 'quadrant' });
                    ctx.fillStyle = '#3498db';
                    ctx.font = '16px Arial';
                    const values = [0.5, 0.667, 0.909, 0.990];
                    const labels = ['n=1', 'n=2', 'n=10', 'n=100'];
                    for (let i = 0; i < values.length; i++) {
                        const x = 50 + i * 100;
                        const y = canvas.height - values[i] * 200;
                        ctx.fillRect(x-2, y-2, 4, 4);
                        ctx.fillText(labels[i], x-15, y-10);
                        ctx.fillText(values[i].toFixed(3), x-20, y+20);
                    }
                    break;
                case 2:
                    // Show running analogy
                    ctx.font = '30px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('ğŸƒâ€â™‚ï¸', canvas.width/4, canvas.height/2);
                    ctx.fillText('ğŸ’§', 3*canvas.width/4, canvas.height/2);
                    break;
                case 3:
                    // Show limit approaching 1
                    drawCoordinateSystem(ctx, canvas, { mode: 'quadrant' });
                    ctx.strokeStyle = '#e74c3c';
                    ctx.setLineDash([5, 5]);
                    ctx.beginPath();
                    ctx.moveTo(0, canvas.height - 200);
                    ctx.lineTo(canvas.width, canvas.height - 200);
                    ctx.stroke();
                    ctx.setLineDash([]);
                    ctx.fillStyle = '#e74c3c';
                    ctx.font = '16px Arial';
                    ctx.fillText('y = 1 (æé™å€¼)', canvas.width - 80, canvas.height - 210);
                    break;
            }
        }

        function drawLimitStepAnimation(ctx, canvas, step) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.textAlign = 'center';

            switch(step) {
                case 1:
                    // Show target analogy
                    ctx.font = '50px Arial';
                    ctx.fillText('ğŸ¯', canvas.width/2, canvas.height/2);
                    ctx.font = '20px Arial';
                    ctx.fillText('å°„ç®­è¶Šæ¥è¶Šæ¥è¿‘é¶å¿ƒ', canvas.width/2, canvas.height/2 + 60);
                    break;
                case 2:
                    // Show mathematical definition
                    ctx.font = '24px Arial';
                    ctx.fillStyle = '#2c3e50';
                    ctx.fillText('lim', canvas.width/2 - 40, canvas.height/2);
                    ctx.font = '16px Arial';
                    ctx.fillText('nâ†’âˆ', canvas.width/2 - 20, canvas.height/2 - 15);
                    ctx.font = '24px Arial';
                    ctx.fillText('xâ‚™ = a', canvas.width/2 + 20, canvas.height/2);
                    break;
                case 3:
                    // Show epsilon-N promise
                    ctx.font = '30px Arial';
                    ctx.fillText('ğŸ“', canvas.width/2, canvas.height/2);
                    ctx.font = '16px Arial';
                    ctx.fillText('Îµ-N æ‰¿è¯ºï¼šç»™æˆ‘æ—¶é—´ï¼Œæ§åˆ¶è¯¯å·®', canvas.width/2, canvas.height/2 + 50);
                    break;
            }
        }

        function initStepStacks() {
            // Initialize all step stacks to show first step
            const stacks = document.querySelectorAll('.step-stack');
            stacks.forEach(stack => {
                const firstStep = stack.querySelector('[data-step="1"]');
                if (firstStep) {
                    firstStep.classList.add('active');
                }
            });
        }

        function drawDefaultAnimation(ctx, canvas) {
            drawCoordinateSystem(ctx, canvas);
            ctx.fillStyle = '#aaa';
            ctx.font = '20px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('(å¯è§†åŒ–åŒºåŸŸ)', canvas.width / 2, canvas.height / 2);
        }

        // Stage 3ï¼šæŒ‰æ­¥éª¤çš„æ¸è¿›å¼å¯è§†åŒ–ï¼ˆä¾‹1-1 ç­‰ï¼‰
        function drawExample11Step(ctx, canvas, step) {
            drawCoordinateSystem(ctx, canvas, { x_origin: 60, y_origin: canvas.height - 40 });
            const width = canvas.width, height = canvas.height;
            // step 1: æ•°è½´
            if (step >= 1) {
                ctx.strokeStyle = '#9ca3af'; ctx.lineWidth = 2;
                ctx.beginPath(); ctx.moveTo(60, height-40); ctx.lineTo(width-20, height-40); ctx.stroke();
                ctx.fillStyle = '#6b7280'; ctx.font = '14px "Microsoft YaHei"';
                ctx.fillText('0', 56, height-20); ctx.fillText('1', width-40, height-20);
            }
            // step 2: ç‚¹åˆ— x_n = n/(n+1)
            if (step >= 2) {
                ctx.fillStyle = 'rgba(99,102,241,0.85)';
                const N = 10;
                for (let n=1; n<=N; n++) {
                    const xn = n/(n+1);
                    const x = 60 + (width-80) * xn;
                    ctx.beginPath(); ctx.arc(x, height-40, 5, 0, 2*Math.PI); ctx.fill();
                }
            }
            // step 3: æé™æ ‡æ³¨ L=1
            if (step >= 3) {
                ctx.strokeStyle = '#ef4444'; ctx.setLineDash([6,4]);
                ctx.beginPath(); ctx.moveTo(width-40, 20); ctx.lineTo(width-40, height-40); ctx.stroke();
                ctx.setLineDash([]);
                ctx.fillStyle = '#ef4444'; ctx.font = '16px "Microsoft YaHei"';
                ctx.fillText('L = 1', width-70, 30);
            }
        }

        const __origDrawAnimation = window.drawAnimation || function(){};
        window.drawAnimation = function(slideIndex, stepCtx) {
            if (!stepCtx) return __origDrawAnimation(slideIndex);
            const { ctx, canvas, step, scene } = stepCtx;
            if (!ctx || !canvas) return;
            ctx.clearRect(0,0,canvas.width,canvas.height);
            if (scene === 'example1_1') {
                drawExample11Step(ctx, canvas, step);
            } else {
                drawDefaultAnimation(ctx, canvas);
            }
        }





        // éšè—åŠ è½½æŒ‡ç¤ºå™¨
        function hideLoading() {
            const loading = document.getElementById('loadingIndicator');
            if (loading) {
                loading.style.display = 'none';
            }
        }

        // é”®ç›˜å¯¼èˆª
        document.addEventListener('keydown', e => {
            if (e.key === 'ArrowLeft') prevSlide();
            if (e.key === 'ArrowRight') nextSlide();
            if (e.key === ' ') { e.preventDefault(); autoPlay(); }
        });

        // é¼ æ ‡æ»šè½®ç¿»é¡µ
        let wheelTimeout;
        document.addEventListener('wheel', e => {
            e.preventDefault();

            // é˜²æŠ–å¤„ç†ï¼Œé¿å…è¿‡å¿«æ»šåŠ¨
            clearTimeout(wheelTimeout);
            wheelTimeout = setTimeout(() => {
                if (e.deltaY > 0) {
                    // å‘ä¸‹æ»šåŠ¨ - ä¸‹ä¸€é¡µï¼ˆå¾ªç¯åˆ°ç¬¬ä¸€é¡µï¼‰
                    if (currentSlide >= totalSlides) {
                        showSlide(1);
                    } else {
                        nextSlide();
                    }
                } else if (e.deltaY < 0) {
                    // å‘ä¸Šæ»šåŠ¨ - ä¸Šä¸€é¡µï¼ˆå¾ªç¯åˆ°æœ€åä¸€é¡µï¼‰
                    if (currentSlide <= 1) {
                        showSlide(totalSlides);
                    } else {
                        prevSlide();
                    }
                }
            }, 100);
        }, { passive: false });

        // äº¤äº’å¼æŒ‰é’®åŠŸèƒ½
        function initInteractiveButtons() {
            // ç›‘å¬åˆ†æ­¥æŒ‰é’®ç‚¹å‡»
            document.addEventListener('click', function(e) {
                // Step-stack: åˆ†æ­¥æŒ‰é’®
                if (e.target.classList.contains('step-btn')) {
                    const stack = e.target.closest('.step-stack');
                    if (stack) {
                        const items = Array.from(stack.querySelectorAll('.step-item'));
                        const currentIndex = items.findIndex(el => el.classList.contains('active'));
                        const nextIndex = Math.min(currentIndex + 1, items.length - 1);
                        if (nextIndex !== currentIndex) {
                            // å…ˆç§»é™¤æ—§é¡¹çš„æ´»åŠ¨çŠ¶æ€
                            items[currentIndex].classList.remove('active');
                            // æ·»åŠ æ–°é¡¹çš„æ´»åŠ¨çŠ¶æ€
                            items[nextIndex].classList.add('active');
                            // ä½¿ç”¨ scheduleMathRender é‡æ–°æ¸²æŸ“æ•°å­¦å…¬å¼
                            window.scheduleMathRender([items[nextIndex]]);
                            const slideEl = e.target.closest('.slide');
                            const canvas = slideEl && slideEl.querySelector('.step-canvas');
                            if (canvas) {
                                const ctx = canvas.getContext('2d');
                                window.drawAnimation(currentSlide, { step: nextIndex + 1, scene: canvas.dataset.scene, ctx, canvas });
                            }
                        }
                    }
                    return;
                }

            });
        }

        // AIæ‚¬æµ®æŒ‰é’®åŠŸèƒ½
        function initAIFloatButton() {
            const aiBtn = document.getElementById('aiFloatBtn');
            if (!aiBtn) return;

            // ç‚¹å‡»è·³è½¬åˆ°AIæ•°åˆ—é¡µé¢
            aiBtn.addEventListener('click', function() {
                // è·å–å½“å‰é¡µé¢çš„ç›®å½•è·¯å¾„
                const currentPath = window.location.pathname;
                const currentDir = currentPath.substring(0, currentPath.lastIndexOf('/'));
                const aiPageUrl = currentDir + '/æ•°åˆ—ai.html';

                // åœ¨æ–°çª—å£ä¸­æ‰“å¼€AIæ•°åˆ—é¡µé¢
                window.open(aiPageUrl, '_blank');
            });

            // æ£€æŸ¥å½“å‰å¹»ç¯ç‰‡æ˜¯å¦ä¸æ•°åˆ—ç›¸å…³ï¼Œæ§åˆ¶æŒ‰é’®æ˜¾ç¤º
            function updateAIButtonVisibility() {
                const currentSlideElement = document.querySelector('.slide.active');
                if (!currentSlideElement) return;

                const slideContent = currentSlideElement.innerHTML.toLowerCase();
                const isSequenceRelated = slideContent.includes('æ•°åˆ—') ||
                                        slideContent.includes('sequence') ||
                                        slideContent.includes('x_n') ||
                                        slideContent.includes('x_{n}') ||
                                        slideContent.includes('é€šé¡¹') ||
                                        slideContent.includes('é¡¹æ•°') ||
                                        slideContent.includes('æ–æ³¢é‚£å¥‘') ||
                                        currentSlide >= 2 && currentSlide <= 8; // æ•°åˆ—ç›¸å…³çš„å¹»ç¯ç‰‡èŒƒå›´

                if (isSequenceRelated) {
                    aiBtn.classList.add('show');
                } else {
                    aiBtn.classList.remove('show');
                }
            }

            // åˆå§‹æ£€æŸ¥
            setTimeout(updateAIButtonVisibility, 500);

            // ç›‘å¬å¹»ç¯ç‰‡åˆ‡æ¢
            const originalShowSlide = window.showSlide;
            window.showSlide = function(n) {
                originalShowSlide(n);
                setTimeout(updateAIButtonVisibility, 300);
            };
        }

        // æä¾›ä¸€ä¸ªå®‰å…¨çš„ã€å¸¦é˜²æŠ–çš„å…¨å±€æ–¹æ³•ä¾›å…¶ä»–è„šæœ¬è°ƒç”¨ä»¥è§¦å‘ MathJax æ¸²æŸ“
        // è¿™æ · lab-math-enhancer ç­‰åŠ¨æ€æ’å…¥å†…å®¹çš„è„šæœ¬å¯ä»¥è°ƒç”¨ window.scheduleMathRender()
        window.scheduleMathRender = (function() {
            let __mj_timer = null;
            return function(rootElements) {
                if (!window.MathJax || !window.MathJax.typesetPromise) {
                    return Promise.resolve();
                }
                if (__mj_timer) clearTimeout(__mj_timer);
                return new Promise((resolve) => {
                    __mj_timer = setTimeout(() => {
                        try {
                            queueMathTypeset(rootElements).then((success) => resolve(success));
                        } catch (e) {
                            resolve();
                        }
                        __mj_timer = null;
                    }, 50);
                });
            };
        })();

        // åˆå§‹åŒ–
        window.onload = () => {
            try {
                // ç¡®ä¿ MathJax å·²åŠ è½½
                const ensureMathJax = () => {
                    return waitForMathJaxReady().catch((err) => {
                        console.warn('MathJax readiness timeout:', err);
                    });
                };

                ensureMathJax().then(() => {
                    // åˆå§‹åŒ–æ‰€æœ‰åŠŸèƒ½
                    initSlides();
                    initInteractiveButtons();
                    initAIFloatButton();
                    initStepStacks();
                    
                    // å¼ºåˆ¶é‡æ–°æ¸²æŸ“æ‰€æœ‰å…¬å¼
                    setTimeout(() => {
                        if (window.MathJax && window.MathJax.typesetPromise) {
                            resetMathJaxState();

                            queueMathTypeset().then((success) => {
                                if (!success) {
                                    console.warn('æ‰€æœ‰å…¬å¼é‡æ–°æ¸²æŸ“æ—¶å‘ç”Ÿé”™è¯¯');
                                } else {
                                    console.log('æ‰€æœ‰å…¬å¼æ¸²æŸ“å®Œæˆ');
                                }
                            });
                        }
                    }, 2000);

                    // ç›‘å¬å¹»ç¯ç‰‡åˆ‡æ¢äº‹ä»¶
                    const originalShowSlide = window.showSlide;
                    window.showSlide = function(n) {
                        originalShowSlide(n);
                        if (window.MathJax && window.MathJax.typesetPromise) {
                            const currentSlide = document.querySelector('.slide.active');
                            if (currentSlide) {
                                queueMathTypeset(currentSlide).then((success) => {
                                    if (!success) {
                                        console.warn('å¹»ç¯ç‰‡åˆ‡æ¢æ—¶çš„å…¬å¼æ¸²æŸ“æœªæˆåŠŸ');
                                    }
                                });
                            }
                        }
                    };
                });
            } catch (error) {
                console.error('Failed to initialize slides:', error);
                hideLoading();
                const container = document.getElementById('slidesContainer');
                if (container) {
                    container.innerHTML = '<div class="error-message">è¯¾ä»¶åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚</div>';
                }
            }
        };

        // å¼ºåˆ¶é‡æ–°æ¸²æŸ“æ‰€æœ‰å…¬å¼çš„å‡½æ•°
        function forceRerenderMath() {
            console.log('å¼€å§‹å¼ºåˆ¶é‡æ–°æ¸²æŸ“å…¬å¼...');
            if (window.MathJax && window.MathJax.typesetPromise) {
                resetMathJaxState();

                queueMathTypeset().then((success) => {
                    if (success) {
                        console.log('å¼ºåˆ¶é‡æ–°æ¸²æŸ“å®Œæˆ');
                        alert('å…¬å¼é‡æ–°æ¸²æŸ“å®Œæˆï¼');
                    } else {
                        console.log('å¼ºåˆ¶é‡æ–°æ¸²æŸ“è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯');
                        alert('é‡æ–°æ¸²æŸ“å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ§åˆ¶å°é”™è¯¯ä¿¡æ¯');
                    }
                });
            } else {
                alert('MathJaxæœªåŠ è½½ï¼Œè¯·åˆ·æ–°é¡µé¢');
            }
        }

        // æ·»åŠ å…¨å±€å‡½æ•°ä¾›è°ƒè¯•ä½¿ç”¨
        window.forceRerenderMath = forceRerenderMath;

        // Lab Menu Toggle Function
        function toggleLabMenu() {
            const labMenu = document.getElementById('labMenu');
            labMenu.classList.toggle('show');
        }

        // Close lab menu when clicking outside
        document.addEventListener('click', function(event) {
            const labMenu = document.getElementById('labMenu');
            const labButton = document.querySelector('.lab-menu-button');

            if (!labMenu.contains(event.target) && !labButton.contains(event.target)) {
                labMenu.classList.remove('show');
            }
        });
    </script>
</body>
</html>
